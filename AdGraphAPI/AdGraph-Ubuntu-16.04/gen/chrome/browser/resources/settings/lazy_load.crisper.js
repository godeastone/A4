// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-a11y-page",properties:{currentRoute:{type:Object,notify:true},prefs:{type:Object,notify:true},focusConfig_:{type:Object,value:function(){const map=new Map;return map}}}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"controlled-button",behaviors:[CrPolicyPrefBehavior,PrefControlBehavior],properties:{endJustified:{type:Boolean,value:false,reflectToAttribute:true},label:String,enforced_:{type:Boolean,computed:"isPrefEnforced(pref.*)",reflectToAttribute:true}},onIndicatorTap_:function(e){e.preventDefault();e.stopPropagation()}});
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
cr.define("settings",function(){class DownloadsBrowserProxy{initializeDownloads(){}selectDownloadLocation(){}resetAutoOpenFileTypes(){}}class DownloadsBrowserProxyImpl{initializeDownloads(){chrome.send("initializeDownloads")}selectDownloadLocation(){chrome.send("selectDownloadLocation")}resetAutoOpenFileTypes(){chrome.send("resetAutoOpenFileTypes")}}cr.addSingletonGetter(DownloadsBrowserProxyImpl);return{DownloadsBrowserProxy:DownloadsBrowserProxy,DownloadsBrowserProxyImpl:DownloadsBrowserProxyImpl}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-downloads-page",behaviors:[WebUIListenerBehavior],properties:{prefs:{type:Object,notify:true},pageVisibility:Object,autoOpenDownloads_:{type:Boolean,value:false},focusConfig_:{type:Object,value:function(){const map=new Map;return map}}},browserProxy_:null,attached:function(){this.browserProxy_=settings.DownloadsBrowserProxyImpl.getInstance();this.addWebUIListener("auto-open-downloads-changed",autoOpen=>{this.autoOpenDownloads_=autoOpen});this.browserProxy_.initializeDownloads()},selectDownloadLocation_:function(){listenOnce(this,"transitionend",()=>{this.browserProxy_.selectDownloadLocation()})},onClearAutoOpenFileTypesTap_:function(){this.browserProxy_.resetAutoOpenFileTypes()}});
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
cr.define("settings",function(){class LanguagesBrowserProxy{getLanguageSettingsPrivate(){}}class LanguagesBrowserProxyImpl{getLanguageSettingsPrivate(){return chrome.languageSettingsPrivate}}cr.addSingletonGetter(LanguagesBrowserProxyImpl);return{LanguagesBrowserProxy:LanguagesBrowserProxy,LanguagesBrowserProxyImpl:LanguagesBrowserProxyImpl}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
(function(){"use strict";cr.exportPath("settings");const MoveType=chrome.languageSettingsPrivate.MoveType;const kLanguageCodeToTranslateCode={nb:"no",fil:"tl","zh-HK":"zh-TW","zh-MO":"zh-TW","zh-SG":"zh-CN"};const kTranslateLanguageSynonyms={he:"iw",jv:"jw"};const preferredLanguagesPrefName=cr.isChromeOS?"settings.language.preferred_languages":"intl.accept_languages";Polymer({is:"settings-languages",behaviors:[PrefsBehavior],properties:{languages:{type:Object,notify:true,readOnly:true},languageHelper:{type:Object,notify:true,readOnly:true,value:function(){return this}},resolver_:{type:Object,value:function(){return new PromiseResolver}},supportedLanguageMap_:{type:Object,value:function(){return new Map}},enabledLanguageSet_:{type:Object,value:function(){return new Set}},supportedInputMethodMap_:{type:Object,value:function(){return new Map}},languageInputMethods_:{type:Object,value:function(){return new Map}},originalProspectiveUILanguage_:String},observers:["prospectiveUILanguageChanged_(prefs.intl.app_locale.value, languages)","preferredLanguagesPrefChanged_("+"prefs."+preferredLanguagesPrefName+".value, languages)","spellCheckDictionariesPrefChanged_("+"prefs.spellcheck.dictionaries.value.*, "+"prefs.spellcheck.forced_dictionaries.value.*, languages)","translateLanguagesPrefChanged_("+"prefs.translate_blocked_languages.value.*, languages)","updateRemovableLanguages_("+"prefs.intl.app_locale.value, languages.enabled)","updateRemovableLanguages_("+"prefs.settings.language.preload_engines.value, "+"prefs.settings.language.enabled_extension_imes.value, "+"languages)"],boundOnInputMethodChanged_:null,boundOnSpellcheckDictionariesChanged_:null,browserProxy_:null,languageSettingsPrivate_:null,attached:function(){this.browserProxy_=settings.LanguagesBrowserProxyImpl.getInstance();this.languageSettingsPrivate_=this.browserProxy_.getLanguageSettingsPrivate();const promises=[];promises[0]=CrSettingsPrefs.initialized;promises[1]=new Promise(resolve=>{this.languageSettingsPrivate_.getLanguageList(resolve)});promises[2]=new Promise(resolve=>{this.languageSettingsPrivate_.getTranslateTargetLanguage(resolve)});if(cr.isChromeOS){promises[3]=new Promise(resolve=>{this.languageSettingsPrivate_.getInputMethodLists(function(lists){resolve(lists.componentExtensionImes.concat(lists.thirdPartyExtensionImes))})});promises[4]=new Promise(resolve=>{this.inputMethodPrivate_.getCurrentInputMethod(resolve)})}if(cr.isWindows||cr.isChromeOS){promises.push(this.browserProxy_.getProspectiveUILanguage().then(prospectiveUILanguage=>{this.originalProspectiveUILanguage_=prospectiveUILanguage||window.navigator.language}))}Promise.all(promises).then(results=>{if(!this.isConnected){return}this.createModel_(results[1],results[2],results[3],results[4]);this.boundOnSpellcheckDictionariesChanged_=this.onSpellcheckDictionariesChanged_.bind(this);this.languageSettingsPrivate_.onSpellcheckDictionariesChanged.addListener(this.boundOnSpellcheckDictionariesChanged_);this.languageSettingsPrivate_.getSpellcheckDictionaryStatuses(this.boundOnSpellcheckDictionariesChanged_);this.resolver_.resolve()});if(cr.isChromeOS){this.boundOnInputMethodChanged_=this.onInputMethodChanged_.bind(this);this.inputMethodPrivate_.onChanged.addListener(assert(this.boundOnInputMethodChanged_))}},detached:function(){if(cr.isChromeOS){this.inputMethodPrivate_.onChanged.removeListener(assert(this.boundOnInputMethodChanged_));this.boundOnInputMethodChanged_=null}if(this.boundOnSpellcheckDictionariesChanged_){this.languageSettingsPrivate_.onSpellcheckDictionariesChanged.removeListener(this.boundOnSpellcheckDictionariesChanged_);this.boundOnSpellcheckDictionariesChanged_=null}},prospectiveUILanguageChanged_:function(prospectiveUILanguage){this.set("languages.prospectiveUILanguage",prospectiveUILanguage||this.originalProspectiveUILanguage_)},preferredLanguagesPrefChanged_:function(){const enabledLanguageStates=this.getEnabledLanguageStates_(this.languages.translateTarget,this.languages.prospectiveUILanguage);this.enabledLanguageSet_.clear();for(let i=0;i<enabledLanguageStates.length;i++)this.enabledLanguageSet_.add(enabledLanguageStates[i].language.code);this.set("languages.enabled",enabledLanguageStates);if(this.boundOnSpellcheckDictionariesChanged_){this.languageSettingsPrivate_.getSpellcheckDictionaryStatuses(this.boundOnSpellcheckDictionariesChanged_)}},spellCheckDictionariesPrefChanged_:function(){const spellCheckSet=this.makeSetFromArray_(this.getPref("spellcheck.dictionaries").value);const spellCheckForcedSet=this.makeSetFromArray_(this.getPref("spellcheck.forced_dictionaries").value);for(let i=0;i<this.languages.enabled.length;i++){const languageState=this.languages.enabled[i];this.set(`languages.enabled.${i}.spellCheckEnabled`,!!spellCheckSet.has(languageState.language.code));this.set(`languages.enabled.${i}.isManaged`,!!spellCheckForcedSet.has(languageState.language.code))}this.set("languages.forcedSpellCheckLanguages",this.getForcedSpellCheckLanguages_(this.languages.enabled))},getForcedSpellCheckLanguages_:function(enabledLanguages){const enabledSet=this.makeSetFromArray_(enabledLanguages.map(x=>x.language.code));const spellCheckForcedDictionaries=this.getPref("spellcheck.forced_dictionaries").value;const forcedLanguages=[];for(let i=0;i<spellCheckForcedDictionaries.length;i++){const code=spellCheckForcedDictionaries[i];if(!enabledSet.has(code)&&this.supportedLanguageMap_.has(code)){forcedLanguages.push({language:this.supportedLanguageMap_.get(code),isManaged:true,downloadDictionaryFailureCount:0})}}return forcedLanguages},translateLanguagesPrefChanged_:function(){const translateBlockedPref=this.getPref("translate_blocked_languages");const translateBlockedSet=this.makeSetFromArray_(translateBlockedPref.value);for(let i=0;i<this.languages.enabled.length;i++){if(this.languages.enabled[i].language.code==this.languages.prospectiveUILanguage){continue}const translateCode=this.convertLanguageCodeForTranslate(this.languages.enabled[i].language.code);this.set("languages.enabled."+i+".translateEnabled",!translateBlockedSet.has(translateCode))}},isAllowedLocale_:function(languageCode){if(!cr.isChromeOS)return true;const pref=this.get("intl.allowed_locales",this.prefs);return pref.value.length==0||pref.value.indexOf(languageCode)!=-1},createModel_:function(supportedLanguages,translateTarget,supportedInputMethods,currentInputMethodId){for(let i=0;i<supportedLanguages.length;i++){const language=supportedLanguages[i];language.supportsUI=!!language.supportsUI;language.supportsTranslate=!!language.supportsTranslate;language.supportsSpellcheck=!!language.supportsSpellcheck;language.isAllowedLocale=this.isAllowedLocale_(language.code);this.supportedLanguageMap_.set(language.code,language)}if(supportedInputMethods){for(let j=0;j<supportedInputMethods.length;j++){const inputMethod=supportedInputMethods[j];inputMethod.enabled=!!inputMethod.enabled;this.supportedInputMethodMap_.set(inputMethod.id,inputMethod);for(let k=0;k<inputMethod.languageCodes.length;k++){const languageCode=inputMethod.languageCodes[k];if(!this.supportedLanguageMap_.has(languageCode))continue;if(!this.languageInputMethods_.has(languageCode))this.languageInputMethods_.set(languageCode,[inputMethod]);else this.languageInputMethods_.get(languageCode).push(inputMethod)}}}let prospectiveUILanguage;if(cr.isChromeOS||cr.isWindows){prospectiveUILanguage=this.getPref("intl.app_locale").value||this.originalProspectiveUILanguage_}const enabledLanguageStates=this.getEnabledLanguageStates_(translateTarget,prospectiveUILanguage);for(let l=0;l<enabledLanguageStates.length;l++)this.enabledLanguageSet_.add(enabledLanguageStates[l].language.code);const forcedSpellCheckLanguages=this.getForcedSpellCheckLanguages_(enabledLanguageStates);const model={supported:supportedLanguages,enabled:enabledLanguageStates,translateTarget:translateTarget,forcedSpellCheckLanguages:forcedSpellCheckLanguages};if(cr.isChromeOS||cr.isWindows)model.prospectiveUILanguage=prospectiveUILanguage;if(cr.isChromeOS){model.inputMethods={supported:supportedInputMethods,enabled:this.getEnabledInputMethods_(),currentId:currentInputMethodId}}this._setLanguages(model)},getEnabledLanguageStates_:function(translateTarget,prospectiveUILanguage){assert(CrSettingsPrefs.isInitialized);const pref=this.getPref(preferredLanguagesPrefName);const enabledLanguageCodes=pref.value.split(",");const spellCheckPref=this.getPref("spellcheck.dictionaries");const spellCheckForcedPref=this.getPref("spellcheck.forced_dictionaries");const spellCheckSet=this.makeSetFromArray_(spellCheckPref.value.concat(spellCheckForcedPref.value));const spellCheckForcedSet=this.makeSetFromArray_(spellCheckForcedPref.value);const translateBlockedPref=this.getPref("translate_blocked_languages");const translateBlockedSet=this.makeSetFromArray_(translateBlockedPref.value);const enabledLanguageStates=[];for(let i=0;i<enabledLanguageCodes.length;i++){const code=enabledLanguageCodes[i];const language=this.supportedLanguageMap_.get(code);if(!language)continue;const languageState={};languageState.language=language;languageState.spellCheckEnabled=!!spellCheckSet.has(code);const translateCode=this.convertLanguageCodeForTranslate(code);languageState.translateEnabled=!!language.supportsTranslate&&!translateBlockedSet.has(translateCode)&&translateCode!=translateTarget&&(!prospectiveUILanguage||code!=prospectiveUILanguage);languageState.isManaged=!!spellCheckForcedSet.has(code);languageState.downloadDictionaryFailureCount=0;enabledLanguageStates.push(languageState)}return enabledLanguageStates},onSpellcheckDictionariesChanged_:function(statuses){const statusMap=new Map;statuses.forEach(status=>{statusMap.set(status.languageCode,status)});["enabled","forcedSpellCheckLanguages"].forEach(collectionName=>{this.languages[collectionName].forEach((languageState,index)=>{const status=statusMap.get(languageState.language.code);if(!status)return;const previousStatus=languageState.downloadDictionaryStatus;const keyPrefix=`languages.${collectionName}.${index}`;this.set(`${keyPrefix}.downloadDictionaryStatus`,status);const failureCountKey=`${keyPrefix}.downloadDictionaryFailureCount`;if(status.downloadFailed&&!(previousStatus&&previousStatus.downloadFailed)){const failureCount=languageState.downloadDictionaryFailureCount+1;this.set(failureCountKey,failureCount)}else if(status.isReady&&!(previousStatus&&previousStatus.isReady)){this.set(failureCountKey,0)}})})},getEnabledInputMethods_:function(){assert(cr.isChromeOS);assert(CrSettingsPrefs.isInitialized);let enabledInputMethodIds=this.getPref("settings.language.preload_engines").value.split(",");enabledInputMethodIds=enabledInputMethodIds.concat(this.getPref("settings.language.enabled_extension_imes").value.split(","));return enabledInputMethodIds.map(id=>this.supportedInputMethodMap_.get(id)).filter(function(inputMethod){return!!inputMethod})},updateEnabledInputMethods_:function(){assert(cr.isChromeOS);const enabledInputMethods=this.getEnabledInputMethods_();const enabledInputMethodSet=this.makeSetFromArray_(enabledInputMethods);for(let i=0;i<this.languages.inputMethods.supported.length;i++){this.set("languages.inputMethods.supported."+i+".enabled",enabledInputMethodSet.has(this.languages.inputMethods.supported[i]))}this.set("languages.inputMethods.enabled",enabledInputMethods)},updateRemovableLanguages_:function(){assert(this.languages);if(cr.isChromeOS)this.updateEnabledInputMethods_();for(let i=0;i<this.languages.enabled.length;i++){const languageState=this.languages.enabled[i];this.set("languages.enabled."+i+".removable",this.canDisableLanguage(languageState.language.code))}},makeSetFromArray_:function(list){return new Set(list)},whenReady:function(){return this.resolver_.promise},isLanguageEnabled:function(languageCode){return this.enabledLanguageSet_.has(languageCode)},enableLanguage:function(languageCode){if(!CrSettingsPrefs.isInitialized)return;this.languageSettingsPrivate_.enableLanguage(languageCode)},disableLanguage:function(languageCode){if(!CrSettingsPrefs.isInitialized)return;assert(this.canDisableLanguage(languageCode));this.deletePrefListItem("spellcheck.dictionaries",languageCode);if(cr.isChromeOS){const inputMethods=this.languageInputMethods_.get(languageCode)||[];for(let i=0;i<inputMethods.length;i++){const inputMethod=inputMethods[i];const supportsOtherEnabledLanguages=inputMethod.languageCodes.some(otherLanguageCode=>otherLanguageCode!=languageCode&&this.isLanguageEnabled(otherLanguageCode));if(!supportsOtherEnabledLanguages)this.removeInputMethod(inputMethod.id)}}this.languageSettingsPrivate_.disableLanguage(languageCode)},canDisableLanguage:function(languageCode){if(languageCode==this.languages.prospectiveUILanguage)return false;if(this.languages.enabled.length==1)return false;if(!cr.isChromeOS)return true;const otherInputMethodsEnabled=this.languages.enabled.some(function(languageState){const otherLanguageCode=languageState.language.code;if(otherLanguageCode==languageCode)return false;const inputMethods=this.languageInputMethods_.get(otherLanguageCode);return inputMethods&&inputMethods.some(function(inputMethod){return this.isComponentIme(inputMethod)&&this.supportedInputMethodMap_.get(inputMethod.id).enabled},this)},this);return otherInputMethodsEnabled},moveLanguage:function(languageCode,upDirection){if(!CrSettingsPrefs.isInitialized)return;if(upDirection){this.languageSettingsPrivate_.moveLanguage(languageCode,MoveType.UP)}else{this.languageSettingsPrivate_.moveLanguage(languageCode,MoveType.DOWN)}},moveLanguageToFront:function(languageCode){if(!CrSettingsPrefs.isInitialized)return;this.languageSettingsPrivate_.moveLanguage(languageCode,MoveType.TOP)},enableTranslateLanguage:function(languageCode){this.languageSettingsPrivate_.setEnableTranslationForLanguage(languageCode,true)},disableTranslateLanguage:function(languageCode){this.languageSettingsPrivate_.setEnableTranslationForLanguage(languageCode,false)},toggleSpellCheck:function(languageCode,enable){if(!this.languages)return;if(enable){const spellCheckPref=this.getPref("spellcheck.dictionaries");this.appendPrefListItem("spellcheck.dictionaries",languageCode)}else{this.deletePrefListItem("spellcheck.dictionaries",languageCode)}},convertLanguageCodeForTranslate:function(languageCode){if(languageCode in kLanguageCodeToTranslateCode)return kLanguageCodeToTranslateCode[languageCode];const main=languageCode.split("-")[0];if(main=="zh"){return languageCode}if(main in kTranslateLanguageSynonyms)return kTranslateLanguageSynonyms[main];return main},getLanguageCodeWithoutRegion:function(languageCode){if(languageCode=="nb"||languageCode=="nn")return"no";const result=languageCode.match(/^([^-]+)-?/);assert(result.length==2);return result[1]},getLanguage:function(languageCode){return this.supportedLanguageMap_.get(languageCode)},retryDownloadDictionary:function(languageCode){this.languageSettingsPrivate_.retryDownloadDictionary(languageCode)}})})();
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-add-languages-dialog",behaviors:[CrScrollableBehavior,settings.FindShortcutBehavior],properties:{languages:{type:Object,notify:true},languageHelper:Object,languagesToAdd_:{type:Object,value:function(){return new Set}},disableActionButton_:{type:Boolean,value:true},filterValue_:{type:String,value:""}},attached:function(){this.$.dialog.showModal()},canHandleFindShortcut:function(){return true},handleFindShortcut:function(){this.$.search.getSearchInput().scrollIntoViewIfNeeded();this.$.search.getSearchInput().focus()},onSearchChanged_:function(e){this.filterValue_=e.detail},getLanguages_:function(){const filterValue=this.filterValue_?this.filterValue_.toLowerCase():null;return this.languages.supported.filter(language=>{const isAvailableLanguage=!this.languageHelper.isLanguageEnabled(language.code);if(!isAvailableLanguage)return false;if(filterValue===null)return true;return language.displayName.toLowerCase().includes(filterValue)||language.nativeDisplayName.toLowerCase().includes(filterValue)})},getDisplayText_:function(language){let displayText=language.displayName;if(language.displayName!=language.nativeDisplayName)displayText+=" - "+language.nativeDisplayName;return displayText},willAdd_:function(languageCode){return this.languagesToAdd_.has(languageCode)},onLanguageCheckboxChange_:function(e){const language=e.model.item;if(e.target.checked)this.languagesToAdd_.add(language.code);else this.languagesToAdd_.delete(language.code);this.disableActionButton_=!this.languagesToAdd_.size},onCancelButtonTap_:function(){this.$.dialog.close()},onActionButtonTap_:function(){this.$.dialog.close();this.languagesToAdd_.forEach(languageCode=>{this.languageHelper.enableLanguage(languageCode)})}});Polymer({is:"iron-a11y-keys",behaviors:[Polymer.IronA11yKeysBehavior],properties:{target:{type:Object,observer:"_targetChanged"},keys:{type:String,reflectToAttribute:true,observer:"_keysChanged"}},attached:function(){if(!this.target){this.target=this.parentNode}},_targetChanged:function(target){this.keyEventTarget=target},_keysChanged:function(){this.removeOwnKeyBindings();this.addOwnKeyBinding(this.keys,"_fireKeysPressed")},_fireKeysPressed:function(event){this.fire("keys-pressed",event.detail,{})}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
const MAX_CUSTOM_DICTIONARY_WORD_BYTES=99;Polymer({is:"settings-edit-dictionary-page",behaviors:[settings.GlobalScrollTargetBehavior],properties:{newWordValue_:String,subpageRoute:{type:Object,value:settings.routes.EDIT_DICTIONARY},words_:{type:Array,value:function(){return[]}}},languageSettingsPrivate:null,ready:function(){this.languageSettingsPrivate=settings.languageSettingsPrivateApiForTest||chrome.languageSettingsPrivate;this.languageSettingsPrivate.getSpellcheckWords(words=>{this.words_=words});this.languageSettingsPrivate.onCustomDictionaryChanged.addListener(this.onCustomDictionaryChanged_.bind(this));this.$.keys.target=this.$.newWord},disableAddButton_:function(word){return word.trim().length==0||this.isWordInvalid_(word)},isWordInvalid_:function(word,duplicateError,lengthError){const trimmedWord=word.trim();if(this.words_.indexOf(trimmedWord)!=-1)return duplicateError||true;else if(trimmedWord.length>MAX_CUSTOM_DICTIONARY_WORD_BYTES)return lengthError||true;return false},onCustomDictionaryChanged_:function(added,removed){const wasEmpty=this.words_.length==0;for(const word of removed)this.arrayDelete("words_",word);for(const word of added){if(this.words_.indexOf(word)==-1)this.unshift("words_",word)}if(wasEmpty&&this.words_.length>0){Polymer.dom.flush();this.$$("#list").notifyResize()}},onKeysPress_:function(e){if(e.detail.key=="enter"&&!this.disableAddButton_(this.newWordValue_)){this.addWordFromInput_()}else if(e.detail.key=="esc"){e.detail.keyboardEvent.target.value=""}},onAddWordTap_:function(e){this.addWordFromInput_();this.$.newWord.focus()},onRemoveWordTap_:function(e){this.languageSettingsPrivate.removeSpellcheckWord(e.model.item)},addWordFromInput_:function(){const word=this.newWordValue_.trim();this.newWordValue_="";if(!word)return;this.languageSettingsPrivate.addSpellcheckWord(word)},hasWords_:function(){return this.words_.length>0}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
cr.exportPath("settings");settings.kMenuCloseDelay=100;const LANGUAGE_SETTING_IS_SHOWN_UMA_NAME="Translate.LanguageSettingsIsShown";(function(){"use strict";Polymer({is:"settings-languages-page",properties:{prefs:{type:Object,notify:true},languages:{type:Object,notify:true},languageHelper:Object,spellCheckSecondaryText_:{type:String,value:"",computed:"getSpellCheckSecondaryText_(languages.enabled.*, "+"languages.forcedSpellCheckLanguages.*, "+"prefs.browser.enable_spellchecking.*)"},spellCheckLanguages_:{type:Array,value:function(){return[]}},spellCheckDisabled_:{type:Boolean,value:false},detailLanguage_:Object,languagesOpened_:{type:Boolean,observer:"onLanguagesOpenedChanged_"},showAddLanguagesDialog_:Boolean,focusConfig_:{type:Object,value:function(){const map=new Map;if(settings.routes.EDIT_DICTIONARY){map.set(settings.routes.EDIT_DICTIONARY.path,"#spellCheckCollapse .subpage-arrow")}return map}}},observers:["updateSpellcheckLanguages_(languages.enabled.*, "+"languages.forcedSpellCheckLanguages.*)","updateSpellcheckEnabled_(prefs.browser.enable_spellchecking.*)"],errorsGreaterThan_:function(downloadDictionaryFailureCount,threshold){return downloadDictionaryFailureCount>threshold},onAddLanguagesTap_:function(e){e.preventDefault();this.showAddLanguagesDialog_=true;this.async(function(){const dialog=this.$$("settings-add-languages-dialog");dialog.addEventListener("close",()=>{this.showAddLanguagesDialog_=false;cr.ui.focusWithoutInk(assert(this.$.addLanguages))})})},isNthLanguage_:function(n,language){const compareLanguage=assert(this.languages.enabled[n]);return language.language==compareLanguage.language},showMoveUp_:function(language){return!this.isNthLanguage_(0,language)&&!this.isNthLanguage_(1,language)},showMoveDown_:function(language){return!this.isNthLanguage_(this.languages.enabled.length-1,language)},isHelpTextHidden_:function(change){return this.languages.enabled.length<=1},disableTranslateCheckbox_:function(language,targetLanguageCode){if(!language.supportsTranslate)return true;return this.languageHelper.convertLanguageCodeForTranslate(language.code)==targetLanguageCode},onTranslateCheckboxChange_:function(e){if(e.target.checked){this.languageHelper.enableTranslateLanguage(this.detailLanguage_.language.code)}else{this.languageHelper.disableTranslateLanguage(this.detailLanguage_.language.code)}this.closeMenuSoon_()},getMenuClass_:function(translateEnabled){if(translateEnabled||cr.isChromeOS||cr.isWindows)return"complex";return""},onMoveToTopTap_:function(){this.$.menu.get().close();this.languageHelper.moveLanguageToFront(this.detailLanguage_.language.code)},onMoveUpTap_:function(){this.$.menu.get().close();this.languageHelper.moveLanguage(this.detailLanguage_.language.code,true)},onMoveDownTap_:function(){this.$.menu.get().close();this.languageHelper.moveLanguage(this.detailLanguage_.language.code,false)},onRemoveLanguageTap_:function(){this.$.menu.get().close();this.languageHelper.disableLanguage(this.detailLanguage_.language.code)},getLanguageListTwoLine_:function(){return cr.isChromeOS||cr.isWindows?"two-line":""},getSpellCheckSecondaryText_:function(){if(this.getSpellCheckDisabled_())return loadTimeData.getString("spellCheckDisabled");const enabledSpellCheckLanguages=this.getSpellCheckLanguages_().filter(function(languageState){return(languageState.spellCheckEnabled||languageState.isManaged)&&languageState.language.supportsSpellcheck});switch(enabledSpellCheckLanguages.length){case 0:return"";case 1:return enabledSpellCheckLanguages[0].language.displayName;case 2:return loadTimeData.getStringF("spellCheckSummaryTwoLanguages",enabledSpellCheckLanguages[0].language.displayName,enabledSpellCheckLanguages[1].language.displayName);case 3:return loadTimeData.getStringF("spellCheckSummaryThreeLanguages",enabledSpellCheckLanguages[0].language.displayName,enabledSpellCheckLanguages[1].language.displayName);default:return loadTimeData.getStringF("spellCheckSummaryMultipleLanguages",enabledSpellCheckLanguages[0].language.displayName,enabledSpellCheckLanguages[1].language.displayName,(enabledSpellCheckLanguages.length-2).toLocaleString())}},getSpellCheckDisabled_:function(){const pref=this.get("browser.enable_spellchecking",this.prefs);return pref.value===false},getSpellCheckLanguages_:function(){return this.languages.enabled.concat(this.languages.forcedSpellCheckLanguages)},updateSpellcheckLanguages_:function(){this.set("spellCheckLanguages_",this.getSpellCheckLanguages_());for(let i=0;i<this.spellCheckLanguages_.length;i++){this.notifyPath(`spellCheckLanguages_.${i}.isManaged`);this.notifyPath(`spellCheckLanguages_.${i}.spellCheckEnabled`);this.notifyPath(`spellCheckLanguages_.${i}.downloadDictionaryFailureCount`)}},updateSpellcheckEnabled_:function(){this.set("spellCheckDisabled_",this.getSpellCheckDisabled_());if(this.spellCheckDisabled_)this.set("spellCheckOpened_",false)},onEditDictionaryTap_:function(){settings.navigateTo(settings.routes.EDIT_DICTIONARY)},onSpellCheckChange_:function(e){const item=e.model.item;if(!item.language.supportsSpellcheck)return;this.languageHelper.toggleSpellCheck(item.language.code,!item.spellCheckEnabled)},onRetryDictionaryDownloadClick_:function(e){assert(this.errorsGreaterThan_(e.model.item.downloadDictionaryFailureCount,0));this.languageHelper.retryDownloadDictionary(e.model.item.language.code)},onSpellCheckNameClick_:function(e){assert(!this.isSpellCheckNameClickDisabled_(e.model.item));this.onSpellCheckChange_(e)},isSpellCheckNameClickDisabled_:function(item){return item.isManaged||!item.language.supportsSpellcheck||item.downloadDictionaryFailureCount>0},getSpellCheckListTwoLine_:function(){return this.spellCheckSecondaryText_.length?"two-line":""},getLanguageItemClass_:function(languageCode,prospectiveUILanguage){if((cr.isChromeOS||cr.isWindows)&&languageCode==prospectiveUILanguage){return"selected"}return""},onDotsTap_:function(e){this.detailLanguage_=Object.assign({},e.model.item);let menu=this.$.menu.getIfExists();if(!menu){menu=this.$.menu.get()}menu.showAt(e.target)},onLanguagesOpenedChanged_:function(newVal,oldVal){if(!oldVal&&newVal){chrome.send("metricsHandler:recordBooleanHistogram",[LANGUAGE_SETTING_IS_SHOWN_UMA_NAME,true])}},closeMenuSoon_:function(){const menu=this.$.menu.get();setTimeout(function(){if(menu.open)menu.close()},settings.kMenuCloseDelay)},toggleExpandButton_:function(e){const expandButtonTag="CR-EXPAND-BUTTON";if(e.target.tagName==expandButtonTag)return;if(!e.currentTarget.hasAttribute("actionable"))return;const expandButton=e.currentTarget.querySelector(expandButtonTag);assert(expandButton);expandButton.expanded=!expandButton.expanded}})})();
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"cr-policy-indicator",behaviors:[CrPolicyIndicatorBehavior],properties:{iconAriaLabel:String}});Polymer({is:"iron-autogrow-textarea",behaviors:[Polymer.IronValidatableBehavior,Polymer.IronControlState],properties:{value:{observer:"_valueChanged",type:String,notify:true},bindValue:{observer:"_bindValueChanged",type:String,notify:true},rows:{type:Number,value:1,observer:"_updateCached"},maxRows:{type:Number,value:0,observer:"_updateCached"},autocomplete:{type:String,value:"off"},autofocus:{type:Boolean,value:false},inputmode:{type:String},placeholder:{type:String},readonly:{type:String},required:{type:Boolean},minlength:{type:Number},maxlength:{type:Number},label:{type:String}},listeners:{input:"_onInput"},get textarea(){return this.$.textarea},get selectionStart(){return this.$.textarea.selectionStart},get selectionEnd(){return this.$.textarea.selectionEnd},set selectionStart(value){this.$.textarea.selectionStart=value},set selectionEnd(value){this.$.textarea.selectionEnd=value},attached:function(){var IS_IOS=navigator.userAgent.match(/iP(?:[oa]d|hone)/);if(IS_IOS){this.$.textarea.style.marginLeft="-3px"}},validate:function(){var valid=this.$.textarea.validity.valid;if(valid){if(this.required&&this.value===""){valid=false}else if(this.hasValidator()){valid=Polymer.IronValidatableBehavior.validate.call(this,this.value)}}this.invalid=!valid;this.fire("iron-input-validate");return valid},_bindValueChanged:function(bindValue){this.value=bindValue},_valueChanged:function(value){var textarea=this.textarea;if(!textarea){return}if(textarea.value!==value){textarea.value=!(value||value===0)?"":value}this.bindValue=value;this.$.mirror.innerHTML=this._valueForMirror();this.fire("bind-value-changed",{value:this.bindValue})},_onInput:function(event){var eventPath=Polymer.dom(event).path;this.value=eventPath?eventPath[0].value:event.target.value},_constrain:function(tokens){var _tokens;tokens=tokens||[""];if(this.maxRows>0&&tokens.length>this.maxRows){_tokens=tokens.slice(0,this.maxRows)}else{_tokens=tokens.slice(0)}while(this.rows>0&&_tokens.length<this.rows){_tokens.push("")}return _tokens.join("<br/>")+"&#160;"},_valueForMirror:function(){var input=this.textarea;if(!input){return}this.tokens=input&&input.value?input.value.replace(/&/gm,"&amp;").replace(/"/gm,"&quot;").replace(/'/gm,"&#39;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").split("\n"):[""];return this._constrain(this.tokens)},_updateCached:function(){this.$.mirror.innerHTML=this._constrain(this.tokens)}});Polymer({is:"paper-textarea",behaviors:[Polymer.PaperInputBehavior,Polymer.IronFormElementBehavior],properties:{_ariaLabelledBy:{observer:"_ariaLabelledByChanged",type:String},_ariaDescribedBy:{observer:"_ariaDescribedByChanged",type:String},rows:{type:Number,value:1},maxRows:{type:Number,value:0}},get selectionStart(){return this.$.input.textarea.selectionStart},set selectionStart(start){this.$.input.textarea.selectionStart=start},get selectionEnd(){return this.$.input.textarea.selectionEnd},set selectionEnd(end){this.$.input.textarea.selectionEnd=end},_ariaLabelledByChanged:function(){this._focusableElement.setAttribute("aria-label",this.label)},_ariaDescribedByChanged:function(ariaDescribedBy){this._focusableElement.setAttribute("aria-describedby",ariaDescribedBy)},get _focusableElement(){return this.inputElement.textarea}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
(function(){"use strict";Polymer({is:"settings-address-edit-dialog",behaviors:[I18nBehavior],properties:{address:Object,title_:String,countries_:Array,countryCode_:{type:String,observer:"onUpdateCountryCode_"},addressWrapper_:Object,phoneNumber_:String,email_:String,canSave_:Boolean},attached:function(){this.countryInfo=settings.address.CountryDetailManagerImpl.getInstance();this.countryInfo.getCountryList().then(countryList=>{this.countries_=countryList;this.title_=this.i18n(this.address.guid?"editAddressTitle":"addAddressTitle");this.phoneNumber_=this.address.phoneNumbers?this.address.phoneNumbers[0]:"";this.email_=this.address.emailAddresses?this.address.emailAddresses[0]:"";this.async(()=>{if(this.countryCode_==this.address.countryCode)this.updateAddressWrapper_();else this.countryCode_=this.address.countryCode})})},long_:function(setting){return setting.component.isLongField?"long":""},updateAddressWrapper_:function(){const countryCode=this.countryCode_||this.countries_[0].countryCode;this.countryInfo.getAddressFormat(countryCode).then(format=>{this.addressWrapper_=format.components.map(component=>component.row.map(c=>new settings.address.AddressComponentUI(this.address,c)));Polymer.dom.flush();this.updateCanSave_();this.fire("on-update-address-wrapper");const dialog=this.$.dialog;if(!dialog.open)dialog.showModal()})},updateCanSave_:function(){const inputs=this.$.dialog.querySelectorAll(".address-column, select");for(let i=0;i<inputs.length;++i){if(inputs[i].value){this.canSave_=true;this.fire("on-update-can-save");return}}this.canSave_=false;this.fire("on-update-can-save")},getCode_:function(country){return country.countryCode||"SPACER"},getName_:function(country){return country.name||"------"},isDivision_:function(country){return!country.countryCode},onCancelTap_:function(){this.$.dialog.cancel()},onSaveButtonTap_:function(){if(!this.canSave_)return;if(!this.address.countryCode)this.address.countryCode=this.countries_[0].countryCode;this.address.phoneNumbers=this.phoneNumber_?[this.phoneNumber_]:[];this.address.emailAddresses=this.email_?[this.email_]:[];this.fire("save-address",this.address);this.$.dialog.close()},onUpdateCountryCode_:function(countryCode){this.address.countryCode=countryCode;this.updateAddressWrapper_()},onCountryChange_:function(){const countrySelect=this.$$("select");this.countryCode_=countrySelect.value}})})();cr.define("settings.address",function(){class AddressComponentUI{constructor(address,component){Object.defineProperty(this,"value",{get:function(){return this.getValue_()},set:function(newValue){this.setValue_(newValue)}});this.address_=address;this.component=component;this.isTextArea=component.field==chrome.autofillPrivate.AddressField.ADDRESS_LINES}getValue_(){const address=this.address_;switch(this.component.field){case chrome.autofillPrivate.AddressField.FULL_NAME:return address.fullNames?address.fullNames[0]:undefined;case chrome.autofillPrivate.AddressField.COMPANY_NAME:return address.companyName;case chrome.autofillPrivate.AddressField.ADDRESS_LINES:return address.addressLines;case chrome.autofillPrivate.AddressField.ADDRESS_LEVEL_1:return address.addressLevel1;case chrome.autofillPrivate.AddressField.ADDRESS_LEVEL_2:return address.addressLevel2;case chrome.autofillPrivate.AddressField.ADDRESS_LEVEL_3:return address.addressLevel3;case chrome.autofillPrivate.AddressField.POSTAL_CODE:return address.postalCode;case chrome.autofillPrivate.AddressField.SORTING_CODE:return address.sortingCode;case chrome.autofillPrivate.AddressField.COUNTRY_CODE:return address.countryCode;default:assertNotReached()}}setValue_(value){const address=this.address_;switch(this.component.field){case chrome.autofillPrivate.AddressField.FULL_NAME:address.fullNames=[value];break;case chrome.autofillPrivate.AddressField.COMPANY_NAME:address.companyName=value;break;case chrome.autofillPrivate.AddressField.ADDRESS_LINES:address.addressLines=value;break;case chrome.autofillPrivate.AddressField.ADDRESS_LEVEL_1:address.addressLevel1=value;break;case chrome.autofillPrivate.AddressField.ADDRESS_LEVEL_2:address.addressLevel2=value;break;case chrome.autofillPrivate.AddressField.ADDRESS_LEVEL_3:address.addressLevel3=value;break;case chrome.autofillPrivate.AddressField.POSTAL_CODE:address.postalCode=value;break;case chrome.autofillPrivate.AddressField.SORTING_CODE:address.sortingCode=value;break;case chrome.autofillPrivate.AddressField.COUNTRY_CODE:address.countryCode=value;break;default:assertNotReached()}}}class CountryDetailManager{getCountryList(){}getAddressFormat(countryCode){}}class CountryDetailManagerImpl{getCountryList(){return new Promise(function(callback){chrome.autofillPrivate.getCountryList(callback)})}getAddressFormat(countryCode){return new Promise(function(callback){chrome.autofillPrivate.getAddressComponents(countryCode,callback)})}}cr.addSingletonGetter(CountryDetailManagerImpl);return{AddressComponentUI:AddressComponentUI,CountryDetailManager:CountryDetailManager,CountryDetailManagerImpl:CountryDetailManagerImpl}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
(function(){"use strict";Polymer({is:"settings-credit-card-edit-dialog",properties:{creditCard:Object,title_:String,monthList_:{type:Array,value:["01","02","03","04","05","06","07","08","09","10","11","12"]},yearList_:Array,expirationYear_:String,expirationMonth_:String},behaviors:[I18nBehavior],checkIfCardExpired_:function(expirationMonth_,expirationYear_){const now=new Date;return expirationYear_<now.getFullYear()||expirationYear_==now.getFullYear()&&expirationMonth_<=now.getMonth()},attached:function(){this.title_=this.i18n(this.creditCard.guid?"editCreditCardTitle":"addCreditCardTitle");this.onCreditCardNameOrNumberChanged_();if(this.creditCard.expirationMonth.length==1)this.creditCard.expirationMonth="0"+this.creditCard.expirationMonth;const date=new Date;let firstYear=date.getFullYear();let lastYear=firstYear+9;let selectedYear=parseInt(this.creditCard.expirationYear,10);if(!selectedYear)selectedYear=firstYear;else if(selectedYear<firstYear)firstYear=selectedYear;else if(selectedYear>lastYear)lastYear=selectedYear;const yearList=[];for(let i=firstYear;i<=lastYear;++i){yearList.push(i.toString())}this.yearList_=yearList;this.async(()=>{this.expirationYear_=selectedYear.toString();this.expirationMonth_=this.creditCard.expirationMonth;this.$.dialog.showModal()})},close:function(){this.$.dialog.close()},onCancelButtonTap_:function(){this.$.dialog.cancel()},onSaveButtonTap_:function(){if(!this.saveEnabled_())return;if(!this.checkIfCardExpired_(this.expirationMonth_,this.expirationYear_)){this.creditCard.expirationYear=this.expirationYear_;this.creditCard.expirationMonth=this.expirationMonth_;this.fire("save-credit-card",this.creditCard);this.close()}},onMonthChange_:function(){this.expirationMonth_=this.monthList_[this.$.month.selectedIndex]},onYearChange_:function(){this.expirationYear_=this.yearList_[this.$.year.selectedIndex]},onCreditCardNameOrNumberChanged_:function(){this.$.saveButton.disabled=!this.saveEnabled_()},saveEnabled_:function(){return this.creditCard.name&&this.creditCard.name.trim()||this.creditCard.cardNumber&&this.creditCard.cardNumber.trim()}})})();
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
class AutofillManager{addAddressListChangedListener(listener){}removeAddressListChangedListener(listener){}getAddressList(callback){}saveAddress(address){}removeAddress(guid){}addCreditCardListChangedListener(listener){}removeCreditCardListChangedListener(listener){}getCreditCardList(callback){}removeCreditCard(guid){}clearCachedCreditCard(guid){}saveCreditCard(creditCard){}}AutofillManager.AddressEntry;AutofillManager.CreditCardEntry;class AutofillManagerImpl{addAddressListChangedListener(listener){chrome.autofillPrivate.onAddressListChanged.addListener(listener)}removeAddressListChangedListener(listener){chrome.autofillPrivate.onAddressListChanged.removeListener(listener)}getAddressList(callback){chrome.autofillPrivate.getAddressList(callback)}saveAddress(address){chrome.autofillPrivate.saveAddress(address)}removeAddress(guid){chrome.autofillPrivate.removeEntry(assert(guid))}addCreditCardListChangedListener(listener){chrome.autofillPrivate.onCreditCardListChanged.addListener(listener)}removeCreditCardListChangedListener(listener){chrome.autofillPrivate.onCreditCardListChanged.removeListener(listener)}getCreditCardList(callback){chrome.autofillPrivate.getCreditCardList(callback)}removeCreditCard(guid){chrome.autofillPrivate.removeEntry(assert(guid))}clearCachedCreditCard(guid){chrome.autofillPrivate.maskCreditCard(assert(guid))}saveCreditCard(creditCard){chrome.autofillPrivate.saveCreditCard(creditCard)}}cr.addSingletonGetter(AutofillManagerImpl);(function(){"use strict";Polymer({is:"settings-autofill-section",behaviors:[I18nBehavior],properties:{addresses:Array,activeAddress:Object,showAddressDialog_:Boolean,creditCards:Array,activeCreditCard:Object,showCreditCardDialog_:Boolean},listeners:{"save-address":"saveAddress_","save-credit-card":"saveCreditCard_"},activeDialogAnchor_:null,autofillManager_:null,setAddressesListener_:null,setCreditCardsListener_:null,attached:function(){const setAddressesListener=list=>{this.addresses=list};const setCreditCardsListener=list=>{this.creditCards=list};this.setAddressesListener_=setAddressesListener;this.setCreditCardsListener_=setCreditCardsListener;this.autofillManager_=AutofillManagerImpl.getInstance();this.autofillManager_.getAddressList(setAddressesListener);this.autofillManager_.getCreditCardList(setCreditCardsListener);this.autofillManager_.addAddressListChangedListener(setAddressesListener);this.autofillManager_.addCreditCardListChangedListener(setCreditCardsListener)},detached:function(){this.autofillManager_.removeAddressListChangedListener(this.setAddressesListener_);this.autofillManager_.removeCreditCardListChangedListener(this.setCreditCardsListener_)},expiration_:function(item){return item.expirationMonth+"/"+item.expirationYear},onAddressMenuTap_:function(e){const menuEvent=e;const item=menuEvent.model["dataHost"]["dataHost"].item;this.activeAddress=Object.assign({},item);const dotsButton=Polymer.dom(e).localTarget;this.$.addressSharedMenu.showAt(dotsButton);this.activeDialogAnchor_=dotsButton},onAddAddressTap_:function(e){e.preventDefault();this.activeAddress={};this.showAddressDialog_=true;this.activeDialogAnchor_=this.$.addAddress},onAddressDialogClosed_:function(){this.showAddressDialog_=false;cr.ui.focusWithoutInk(assert(this.activeDialogAnchor_));this.activeDialogAnchor_=null},onMenuEditAddressTap_:function(e){e.preventDefault();this.showAddressDialog_=true;this.$.addressSharedMenu.close()},onRemoteEditAddressTap_:function(){window.open(this.i18n("manageAddressesUrl"))},onMenuRemoveAddressTap_:function(){this.autofillManager_.removeAddress(this.activeAddress.guid);this.$.addressSharedMenu.close()},onCreditCardMenuTap_:function(e){const menuEvent=e;const item=menuEvent.model["dataHost"]["dataHost"].item;this.activeCreditCard=Object.assign({},item);const dotsButton=Polymer.dom(e).localTarget;this.$.creditCardSharedMenu.showAt(dotsButton);this.activeDialogAnchor_=dotsButton},onAddCreditCardTap_:function(e){e.preventDefault();const date=new Date;const expirationMonth=date.getMonth()+1;this.activeCreditCard={expirationMonth:expirationMonth.toString(),expirationYear:date.getFullYear().toString()};this.showCreditCardDialog_=true;this.activeDialogAnchor_=this.$.addCreditCard},onCreditCardDialogClosed_:function(){this.showCreditCardDialog_=false;cr.ui.focusWithoutInk(assert(this.activeDialogAnchor_));this.activeDialogAnchor_=null},onMenuEditCreditCardTap_:function(e){e.preventDefault();if(this.activeCreditCard.metadata.isLocal)this.showCreditCardDialog_=true;else this.onRemoteEditCreditCardTap_();this.$.creditCardSharedMenu.close()},onRemoteEditCreditCardTap_:function(){window.open(this.i18n("manageCreditCardsUrl"))},onMenuRemoveCreditCardTap_:function(){this.autofillManager_.removeCreditCard(this.activeCreditCard.guid);this.$.creditCardSharedMenu.close()},onMenuClearCreditCardTap_:function(){this.autofillManager_.clearCachedCreditCard(this.activeCreditCard.guid);this.$.creditCardSharedMenu.close()},showDots_:function(metadata){return!!(metadata.isLocal||metadata.isCached)},hasSome_:function(list){return!!(list&&list.length)},isDisabled_:function(pref){return!!pref&&pref.value===false},saveAddress_:function(event){this.autofillManager_.saveAddress(event.detail)},saveCreditCard_:function(event){this.autofillManager_.saveCreditCard(event.detail)},getOnOffLabel_:function(toggleValue){return toggleValue?this.i18n("toggleOn"):this.i18n("toggleOff")}})})();
// Copyright 2018 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
const ListPropertyUpdateBehavior={updateList:function(propertyName,itemUidGetter,updatedList){const list=this[propertyName];const splices=Polymer.ArraySplice.calculateSplices(updatedList.map(itemUidGetter),list.map(itemUidGetter));splices.forEach(splice=>{const index=splice.index;const deleteCount=splice.removed.length;splice.removed=list.slice(index,index+deleteCount);splice.object=list;splice.type="splice";const added=updatedList.slice(index,index+splice.addedCount);const spliceParams=[index,deleteCount].concat(added);list.splice.apply(list,spliceParams)});if(splices.length>0)this.notifySplices(propertyName,splices)}};
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
const ShowPasswordBehavior={properties:{item:Object},getPasswordInputType_:function(){return this.item.password||this.item.entry.federationText?"text":"password"},showPasswordTitle_:function(password,hide,show){return password?hide:show},getIconClass_:function(){return this.item.password?"icon-visibility-off":"icon-visibility"},getPassword_:function(){if(!this.item)return"";return this.item.entry.federationText||this.item.password||" ".repeat(this.item.entry.numCharactersInPassword)},onShowPasswordButtonTap_:function(){if(this.item.password)this.set("item.password","");else this.fire("show-password",this)}};ShowPasswordBehavior.UiEntryWithPassword;
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
(function(){"use strict";Polymer({is:"password-edit-dialog",behaviors:[ShowPasswordBehavior],attached:function(){this.$.dialog.showModal()},close:function(){this.$.dialog.close()},onActionButtonTap_:function(){this.close()},onInputFocus_:function(event){const inputElement=Polymer.dom(event).localTarget.inputElement;inputElement.setSelectionRange(0,0);inputElement.focus();inputElement.select()}})})();
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
(function(){"use strict";const States={START:"START",IN_PROGRESS:"IN_PROGRESS",ERROR:"ERROR"};const ProgressStatus=chrome.passwordsPrivate.ExportProgressStatus;const progressBarDelayMs=100;const progressBarBlockMs=1e3;Polymer({is:"passwords-export-dialog",behaviors:[I18nBehavior],properties:{exportErrorMessage:String},listeners:{cancel:"close"},passwordManager_:null,onPasswordsFileExportProgressListener_:null,progressTaskToken_:null,delayedCompletionToken_:null,delayedProgress_:null,attached:function(){this.passwordManager_=PasswordManagerImpl.getInstance();this.switchToDialog_(States.START);this.onPasswordsFileExportProgressListener_=this.onPasswordsFileExportProgress_.bind(this);this.passwordManager_.requestExportProgressStatus(status=>{if(status==ProgressStatus.IN_PROGRESS)this.switchToDialog_(States.IN_PROGRESS)});this.passwordManager_.addPasswordsFileExportProgressListener(this.onPasswordsFileExportProgressListener_)},onPasswordsFileExportProgress_(progress){const progressBlocked=!this.progressTaskToken_&&!!this.delayedCompletionToken_;if(!progressBlocked){clearTimeout(this.progressTaskToken_);this.progressTaskToken_=null;this.processProgress_(progress)}else{this.delayedProgress_=progress}},progressTask_(){this.progressTaskToken_=null;this.switchToDialog_(States.IN_PROGRESS);this.delayedCompletionToken_=setTimeout(this.delayedCompletionTask_.bind(this),progressBarBlockMs)},delayedCompletionTask_(){this.delayedCompletionToken_=null;if(this.delayedProgress_){this.processProgress_(this.delayedProgress_);this.delayedProgress_=null}},close:function(){clearTimeout(this.progressTaskToken_);clearTimeout(this.delayedCompletionToken_);this.progressTaskToken_=null;this.delayedCompletionToken_=null;this.passwordManager_.removePasswordsFileExportProgressListener(this.onPasswordsFileExportProgressListener_);if(this.$.dialog_start.open)this.$.dialog_start.close();if(this.$.dialog_progress.open)this.$.dialog_progress.close();if(this.$.dialog_error.open)this.$.dialog_error.close()},onExportTap_:function(){this.passwordManager_.exportPasswords(()=>{if(chrome.runtime.lastError&&chrome.runtime.lastError.message=="in-progress"){this.switchToDialog_(States.IN_PROGRESS)}})},processProgress_(progress){if(progress.status==ProgressStatus.IN_PROGRESS){this.progressTaskToken_=setTimeout(this.progressTask_.bind(this),progressBarDelayMs);return}if(progress.status==ProgressStatus.SUCCEEDED){this.close();return}if(progress.status==ProgressStatus.FAILED_WRITE_FAILED){this.exportErrorMessage=this.i18n("exportPasswordsFailTitle",progress.folderName);this.switchToDialog_(States.ERROR);return}},switchToDialog_(state){this.$.dialog_start.open=false;this.$.dialog_error.open=false;this.$.dialog_progress.open=false;if(state==States.START)this.$.dialog_start.showModal();if(state==States.ERROR)this.$.dialog_error.showModal();if(state==States.IN_PROGRESS)this.$.dialog_progress.showModal()},onCancelButtonTap_:function(){this.close()},onCancelProgressButtonTap_:function(){this.passwordManager_.cancelExportPasswords();this.close()}})})();
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"password-list-item",behaviors:[FocusRowBehavior,ShowPasswordBehavior],onReadonlyInputTap_:function(){if(this.password)this.$$("#password").select()},onPasswordMenuTap_:function(){this.fire("password-menu-tap",{target:this.$.passwordMenu,listItem:this})},getMoreActionsLabel_:function(item){return loadTimeData.getStringF(item.entry.federationText?"passwordRowFederatedMoreActionsButton":"passwordRowMoreActionsButton",item.entry.loginPair.username,item.entry.loginPair.urls.shown)}});
// Copyright 2018 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
class PasswordManagerProxy{addSavedPasswordListChangedListener(listener){}removeSavedPasswordListChangedListener(listener){}getSavedPasswordList(callback){}removeSavedPassword(index){}addExceptionListChangedListener(listener){}removeExceptionListChangedListener(listener){}getExceptionList(callback){}removeException(index){}undoRemoveSavedPasswordOrException(){}getPlaintextPassword(index,callback){}importPasswords(){}exportPasswords(callback){}requestExportProgressStatus(callback){}addPasswordsFileExportProgressListener(listener){}removePasswordsFileExportProgressListener(listener){}}PasswordManagerProxy.PasswordUiEntry;PasswordManagerProxy.LoginPair;PasswordManagerProxy.ExceptionEntry;PasswordManagerProxy.PlaintextPasswordEvent;PasswordManagerProxy.UiEntryWithPassword;PasswordManagerProxy.PasswordExportProgress;PasswordManagerProxy.ExportProgressStatus;class PasswordManagerImpl{addSavedPasswordListChangedListener(listener){chrome.passwordsPrivate.onSavedPasswordsListChanged.addListener(listener)}removeSavedPasswordListChangedListener(listener){chrome.passwordsPrivate.onSavedPasswordsListChanged.removeListener(listener)}getSavedPasswordList(callback){chrome.passwordsPrivate.getSavedPasswordList(callback)}removeSavedPassword(index){chrome.passwordsPrivate.removeSavedPassword(index)}addExceptionListChangedListener(listener){chrome.passwordsPrivate.onPasswordExceptionsListChanged.addListener(listener)}removeExceptionListChangedListener(listener){chrome.passwordsPrivate.onPasswordExceptionsListChanged.removeListener(listener)}getExceptionList(callback){chrome.passwordsPrivate.getPasswordExceptionList(callback)}removeException(index){chrome.passwordsPrivate.removePasswordException(index)}undoRemoveSavedPasswordOrException(){chrome.passwordsPrivate.undoRemoveSavedPasswordOrException()}getPlaintextPassword(index,callback){const listener=function(reply){if(reply.index==index){chrome.passwordsPrivate.onPlaintextPasswordRetrieved.removeListener(listener);callback(reply)}};chrome.passwordsPrivate.onPlaintextPasswordRetrieved.addListener(listener);chrome.passwordsPrivate.requestPlaintextPassword(index)}importPasswords(){chrome.passwordsPrivate.importPasswords()}exportPasswords(callback){chrome.passwordsPrivate.exportPasswords(callback)}requestExportProgressStatus(callback){chrome.passwordsPrivate.requestExportProgressStatus(callback)}addPasswordsFileExportProgressListener(listener){chrome.passwordsPrivate.onPasswordsFileExportProgress.addListener(listener)}removePasswordsFileExportProgressListener(listener){chrome.passwordsPrivate.onPasswordsFileExportProgress.removeListener(listener)}}cr.addSingletonGetter(PasswordManagerImpl);
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
let PasswordUiEntryEvent;let ExceptionEntryEntryEvent;(function(){"use strict";Polymer({is:"passwords-section",behaviors:[I18nBehavior,ListPropertyUpdateBehavior,Polymer.IronA11yKeysBehavior,settings.GlobalScrollTargetBehavior],properties:{prefs:{type:Object,notify:true},savedPasswords:{type:Array,value:()=>[]},passwordExceptions:{type:Array,value:()=>[]},toastDuration_:{type:Number,value:5e3},subpageRoute:{type:Object,value:settings.routes.MANAGE_PASSWORDS},activePassword:Object,keyEventTarget:{type:Object,value:()=>document},showExportPasswords_:{type:Boolean,computed:"hasPasswords_(savedPasswords.splices)"},showImportPasswords_:{type:Boolean,value:function(){return loadTimeData.valueExists("showImportPasswords")&&loadTimeData.getBoolean("showImportPasswords")}},showPasswordEditDialog_:Boolean,filter:{type:String,value:""},lastFocused_:Object},listeners:{"show-password":"showPassword_","password-menu-tap":"onPasswordMenuTap_","export-passwords":"onExportPasswords_"},keyBindings:{"ctrl+z":"onUndoKeyBinding_"},activeDialogAnchor_:null,passwordManager_:null,setSavedPasswordsListener_:null,setPasswordExceptionsListener_:null,attached:function(){const setSavedPasswordsListener=list=>this.updateList("savedPasswords",item=>`${item.entry.index}_${item.entry.loginPair.urls.shown}`,list.map(entry=>({entry:entry,password:""})));const setPasswordExceptionsListener=list=>{this.passwordExceptions=list};this.setSavedPasswordsListener_=setSavedPasswordsListener;this.setPasswordExceptionsListener_=setPasswordExceptionsListener;this.passwordManager_=PasswordManagerImpl.getInstance();this.passwordManager_.getSavedPasswordList(setSavedPasswordsListener);this.passwordManager_.getExceptionList(setPasswordExceptionsListener);this.passwordManager_.addSavedPasswordListChangedListener(setSavedPasswordsListener);this.passwordManager_.addExceptionListChangedListener(setPasswordExceptionsListener);this.notifySplices("savedPasswords",[]);Polymer.RenderStatus.afterNextRender(this,function(){Polymer.IronA11yAnnouncer.requestAvailability()})},detached:function(){this.passwordManager_.removeSavedPasswordListChangedListener(this.setSavedPasswordsListener_);this.passwordManager_.removeExceptionListChangedListener(this.setPasswordExceptionsListener_);if(this.$.undoToast.open)this.$.undoToast.hide()},onMenuEditPasswordTap_:function(e){e.preventDefault();this.$.menu.close();this.showPasswordEditDialog_=true},onPasswordEditDialogClosed_:function(){this.showPasswordEditDialog_=false;cr.ui.focusWithoutInk(assert(this.activeDialogAnchor_));this.activeDialogAnchor_=null;this.activePassword.notifyPath("item.password")},getFilteredPasswords_:function(filter){if(!filter)return this.savedPasswords.slice();return this.savedPasswords.filter(p=>[p.entry.loginPair.urls.shown,p.entry.loginPair.username].some(term=>term.toLowerCase().includes(filter.toLowerCase())))},passwordExceptionFilter_:function(filter){return exception=>exception.urls.shown.toLowerCase().includes(filter.toLowerCase())},onMenuRemovePasswordTap_:function(){this.passwordManager_.removeSavedPassword(this.activePassword.item.entry.index);this.fire("iron-announce",{text:this.$.undoLabel.textContent});this.$.undoToast.show();this.$.menu.close()},onUndoKeyBinding_:function(event){this.passwordManager_.undoRemoveSavedPasswordOrException();this.$.undoToast.hide();event.preventDefault()},onUndoButtonTap_:function(){this.passwordManager_.undoRemoveSavedPasswordOrException();this.$.undoToast.hide()},onRemoveExceptionButtonTap_:function(e){this.passwordManager_.removeException(e.model.item.index)},onPasswordMenuTap_:function(event){const menu=this.$.menu;const target=event.detail.target;this.activePassword=event.detail.listItem;menu.showAt(target);this.activeDialogAnchor_=target},onImportExportMenuTap_:function(){const menu=this.$.exportImportMenu;const target=this.$$("#exportImportMenuButton");menu.showAt(target);this.activeDialogAnchor_=target},undoRemoveSavedPasswordOrException_:function(event){this.passwordManager_.undoRemoveSavedPasswordOrException()},onImportTap_:function(){this.passwordManager_.importPasswords();this.$.exportImportMenu.close()},onExportTap_:function(){this.showPasswordsExportDialog_=true;this.$.exportImportMenu.close()},onPasswordsExportDialogClosed_:function(){this.showPasswordsExportDialog_=false;cr.ui.focusWithoutInk(assert(this.activeDialogAnchor_));this.activeDialogAnchor_=null},hasSome_:function(list){return!!(list&&list.length)},showPassword_:function(event){this.passwordManager_.getPlaintextPassword(event.detail.item.entry.index,item=>{event.detail.set("item.password",item.plaintextPassword)})},getOnOffLabel_:function(toggleValue){return toggleValue?this.i18n("toggleOn"):this.i18n("toggleOff")},hasPasswords_:function(){return this.savedPasswords.length>0},showImportOrExportPasswords_:function(showExportPasswords,showImportPasswords){return showExportPasswords||showImportPasswords}})})();
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-passwords-and-forms-page",behaviors:[PrefsBehavior],properties:{passwordFilter_:String,focusConfig:Object},ready:function(){this.focusConfig_=new Map;if(settings.routes.AUTOFILL){this.focusConfig_.set(settings.routes.AUTOFILL.path,"#autofillManagerButton")}if(settings.routes.MANAGE_PASSWORDS){this.focusConfig_.set(settings.routes.MANAGE_PASSWORDS.path,"#passwordManagerButton .subpage-arrow")}},onAutofillTap_:function(event){settings.navigateTo(settings.routes.AUTOFILL)},onPasswordsTap_:function(event){settings.navigateTo(settings.routes.MANAGE_PASSWORDS)}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-cloud-printers",properties:{prefs:{type:Object,notify:true}}});
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
cr.define("settings",function(){class PrintingBrowserProxy{openSystemPrintDialog(){}}class PrintingBrowserProxyImpl{openSystemPrintDialog(){chrome.send("openSystemPrintDialog")}}cr.addSingletonGetter(PrintingBrowserProxyImpl);return{PrintingBrowserProxy:PrintingBrowserProxy,PrintingBrowserProxyImpl:PrintingBrowserProxyImpl}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-printing-page",properties:{prefs:{type:Object,notify:true},searchTerm:{type:String},focusConfig_:{type:Object,value:function(){const map=new Map;if(settings.routes.CLOUD_PRINTERS){map.set(settings.routes.CLOUD_PRINTERS.path,"#cloudPrinters .subpage-arrow")}return map}}},onTapLocalPrinters_:function(){settings.PrintingBrowserProxyImpl.getInstance().openSystemPrintDialog()},onTapCloudPrinters_:function(){settings.navigateTo(settings.routes.CLOUD_PRINTERS)}});Polymer({is:"iron-pages",behaviors:[Polymer.IronResizableBehavior,Polymer.IronSelectableBehavior],properties:{activateEvent:{type:String,value:null}},observers:["_selectedPageChanged(selected)"],_selectedPageChanged:function(selected,old){this.async(this.notifyResize)}});Polymer({is:"paper-tab",behaviors:[Polymer.IronControlState,Polymer.IronButtonState,Polymer.PaperRippleBehavior],properties:{link:{type:Boolean,value:false,reflectToAttribute:true}},hostAttributes:{role:"tab"},listeners:{down:"_updateNoink",tap:"_onTap"},attached:function(){this._updateNoink()},get _parentNoink(){var parent=Polymer.dom(this).parentNode;return!!parent&&!!parent.noink},_updateNoink:function(){this.noink=!!this.noink||!!this._parentNoink},_onTap:function(event){if(this.link){var anchor=this.queryEffectiveChildren("a");if(!anchor){return}if(event.target===anchor){return}anchor.click()}}});Polymer({is:"paper-tabs",behaviors:[Polymer.IronResizableBehavior,Polymer.IronMenubarBehavior],properties:{noink:{type:Boolean,value:false,observer:"_noinkChanged"},noBar:{type:Boolean,value:false},noSlide:{type:Boolean,value:false},scrollable:{type:Boolean,value:false},fitContainer:{type:Boolean,value:false},disableDrag:{type:Boolean,value:false},hideScrollButtons:{type:Boolean,value:false},alignBottom:{type:Boolean,value:false},selectable:{type:String,value:"paper-tab"},autoselect:{type:Boolean,value:false},autoselectDelay:{type:Number,value:0},_step:{type:Number,value:10},_holdDelay:{type:Number,value:1},_leftHidden:{type:Boolean,value:false},_rightHidden:{type:Boolean,value:false},_previousTab:{type:Object}},hostAttributes:{role:"tablist"},listeners:{"iron-resize":"_onTabSizingChanged","iron-items-changed":"_onTabSizingChanged","iron-select":"_onIronSelect","iron-deselect":"_onIronDeselect"},keyBindings:{"left:keyup right:keyup":"_onArrowKeyup"},created:function(){this._holdJob=null;this._pendingActivationItem=undefined;this._pendingActivationTimeout=undefined;this._bindDelayedActivationHandler=this._delayedActivationHandler.bind(this);this.addEventListener("blur",this._onBlurCapture.bind(this),true)},ready:function(){this.setScrollDirection("y",this.$.tabsContainer)},detached:function(){this._cancelPendingActivation()},_noinkChanged:function(noink){var childTabs=Polymer.dom(this).querySelectorAll("paper-tab");childTabs.forEach(noink?this._setNoinkAttribute:this._removeNoinkAttribute)},_setNoinkAttribute:function(element){element.setAttribute("noink","")},_removeNoinkAttribute:function(element){element.removeAttribute("noink")},_computeScrollButtonClass:function(hideThisButton,scrollable,hideScrollButtons){if(!scrollable||hideScrollButtons){return"hidden"}if(hideThisButton){return"not-visible"}return""},_computeTabsContentClass:function(scrollable,fitContainer){return scrollable?"scrollable"+(fitContainer?" fit-container":""):" fit-container"},_computeSelectionBarClass:function(noBar,alignBottom){if(noBar){return"hidden"}else if(alignBottom){return"align-bottom"}return""},_onTabSizingChanged:function(){this.debounce("_onTabSizingChanged",function(){this._scroll();this._tabChanged(this.selectedItem)},10)},_onIronSelect:function(event){this._tabChanged(event.detail.item,this._previousTab);this._previousTab=event.detail.item;this.cancelDebouncer("tab-changed")},_onIronDeselect:function(event){this.debounce("tab-changed",function(){this._tabChanged(null,this._previousTab);this._previousTab=null},1)},_activateHandler:function(){this._cancelPendingActivation();Polymer.IronMenuBehaviorImpl._activateHandler.apply(this,arguments)},_scheduleActivation:function(item,delay){this._pendingActivationItem=item;this._pendingActivationTimeout=this.async(this._bindDelayedActivationHandler,delay)},_delayedActivationHandler:function(){var item=this._pendingActivationItem;this._pendingActivationItem=undefined;this._pendingActivationTimeout=undefined;item.fire(this.activateEvent,null,{bubbles:true,cancelable:true})},_cancelPendingActivation:function(){if(this._pendingActivationTimeout!==undefined){this.cancelAsync(this._pendingActivationTimeout);this._pendingActivationItem=undefined;this._pendingActivationTimeout=undefined}},_onArrowKeyup:function(event){if(this.autoselect){this._scheduleActivation(this.focusedItem,this.autoselectDelay)}},_onBlurCapture:function(event){if(event.target===this._pendingActivationItem){this._cancelPendingActivation()}},get _tabContainerScrollSize(){return Math.max(0,this.$.tabsContainer.scrollWidth-this.$.tabsContainer.offsetWidth)},_scroll:function(e,detail){if(!this.scrollable){return}var ddx=detail&&-detail.ddx||0;this._affectScroll(ddx)},_down:function(e){this.async(function(){if(this._defaultFocusAsync){this.cancelAsync(this._defaultFocusAsync);this._defaultFocusAsync=null}},1)},_affectScroll:function(dx){this.$.tabsContainer.scrollLeft+=dx;var scrollLeft=this.$.tabsContainer.scrollLeft;this._leftHidden=scrollLeft===0;this._rightHidden=scrollLeft===this._tabContainerScrollSize},_onLeftScrollButtonDown:function(){this._scrollToLeft();this._holdJob=setInterval(this._scrollToLeft.bind(this),this._holdDelay)},_onRightScrollButtonDown:function(){this._scrollToRight();this._holdJob=setInterval(this._scrollToRight.bind(this),this._holdDelay)},_onScrollButtonUp:function(){clearInterval(this._holdJob);this._holdJob=null},_scrollToLeft:function(){this._affectScroll(-this._step)},_scrollToRight:function(){this._affectScroll(this._step)},_tabChanged:function(tab,old){if(!tab){this.$.selectionBar.classList.remove("expand");this.$.selectionBar.classList.remove("contract");this._positionBar(0,0);return}var r=this.$.tabsContent.getBoundingClientRect();var w=r.width;var tabRect=tab.getBoundingClientRect();var tabOffsetLeft=tabRect.left-r.left;this._pos={width:this._calcPercent(tabRect.width,w),left:this._calcPercent(tabOffsetLeft,w)};if(this.noSlide||old==null){this.$.selectionBar.classList.remove("expand");this.$.selectionBar.classList.remove("contract");this._positionBar(this._pos.width,this._pos.left);return}var oldRect=old.getBoundingClientRect();var oldIndex=this.items.indexOf(old);var index=this.items.indexOf(tab);var m=5;this.$.selectionBar.classList.add("expand");var moveRight=oldIndex<index;var isRTL=this._isRTL;if(isRTL){moveRight=!moveRight}if(moveRight){this._positionBar(this._calcPercent(tabRect.left+tabRect.width-oldRect.left,w)-m,this._left)}else{this._positionBar(this._calcPercent(oldRect.left+oldRect.width-tabRect.left,w)-m,this._calcPercent(tabOffsetLeft,w)+m)}if(this.scrollable){this._scrollToSelectedIfNeeded(tabRect.width,tabOffsetLeft)}},_scrollToSelectedIfNeeded:function(tabWidth,tabOffsetLeft){var l=tabOffsetLeft-this.$.tabsContainer.scrollLeft;if(l<0){this.$.tabsContainer.scrollLeft+=l}else{l+=tabWidth-this.$.tabsContainer.offsetWidth;if(l>0){this.$.tabsContainer.scrollLeft+=l}}},_calcPercent:function(w,w0){return 100*w/w0},_positionBar:function(width,left){width=width||0;left=left||0;this._width=width;this._left=left;this.transform("translateX("+left+"%) scaleX("+width/100+")",this.$.selectionBar)},_onBarTransitionEnd:function(e){var cl=this.$.selectionBar.classList;if(cl.contains("expand")){cl.remove("expand");cl.add("contract");this._positionBar(this._pos.width,this._pos.left)}else if(cl.contains("contract")){cl.remove("contract")}}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
let ImportantSite;cr.define("settings",function(){class ClearBrowsingDataBrowserProxy{clearBrowsingData(dataTypes,timePeriod,importantSites){}getImportantSites(){}initialize(){}}class ClearBrowsingDataBrowserProxyImpl{clearBrowsingData(dataTypes,timePeriod,importantSites){return cr.sendWithPromise("clearBrowsingData",dataTypes,timePeriod,importantSites)}getImportantSites(){return cr.sendWithPromise("getImportantSites")}initialize(){return cr.sendWithPromise("initializeClearBrowsingData")}}cr.addSingletonGetter(ClearBrowsingDataBrowserProxyImpl);return{ClearBrowsingDataBrowserProxy:ClearBrowsingDataBrowserProxy,ClearBrowsingDataBrowserProxyImpl:ClearBrowsingDataBrowserProxyImpl}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-history-deletion-dialog",attached:function(){this.$.dialog.showModal()},onOkTap_:function(){this.$.dialog.close()}});
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"important-site-checkbox",properties:{site:Object,disabled:{type:Boolean,value:false}}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-clear-browsing-data-dialog",behaviors:[WebUIListenerBehavior,settings.RouteObserverBehavior],properties:{prefs:{type:Object,notify:true},counters_:{type:Object,value:function(){return{}}},clearFromOptions_:{readOnly:true,type:Array,value:[{value:0,name:loadTimeData.getString("clearPeriodHour")},{value:1,name:loadTimeData.getString("clearPeriod24Hours")},{value:2,name:loadTimeData.getString("clearPeriod7Days")},{value:3,name:loadTimeData.getString("clearPeriod4Weeks")},{value:4,name:loadTimeData.getString("clearPeriodEverything")}]},clearingInProgress_:{type:Boolean,value:false},clearButtonDisabled_:{type:Boolean,value:false},isSupervised_:{type:Boolean,value:function(){return loadTimeData.getBoolean("isSupervised")}},showHistoryDeletionDialog_:{type:Boolean,value:false},isSignedIn_:{type:Boolean,value:false},isSyncingHistory_:{type:Boolean,value:false},importantSites_:{type:Array,value:function(){return[]}},importantSitesFlagEnabled_:{type:Boolean,value:function(){return loadTimeData.getBoolean("importantSitesInCbd")}},showImportantSitesDialog_:{type:Boolean,value:false},showImportantSitesCacheSubtitle_:{type:Boolean,value:false},dialogOpenedTime_:{type:Number,value:0}},listeners:{"settings-boolean-control-change":"updateClearButtonState_"},browserProxy_:null,ready:function(){this.addWebUIListener("update-sync-state",this.updateSyncState_.bind(this));this.addWebUIListener("update-counter-text",this.updateCounterText_.bind(this))},attached:function(){this.browserProxy_=settings.ClearBrowsingDataBrowserProxyImpl.getInstance();this.dialogOpenedTime_=Date.now();this.browserProxy_.initialize().then(()=>{this.$.clearBrowsingDataDialog.showModal()});if(this.importantSitesFlagEnabled_){this.browserProxy_.getImportantSites().then(sites=>{this.importantSites_=sites})}},isClearButtonDisabled_:function(clearingInProgress,clearButtonDisabled){return clearingInProgress||clearButtonDisabled},updateClearButtonState_:function(){const tab=this.$.tabs.selectedItem;if(!tab)return;this.clearButtonDisabled_=this.getSelectedDataTypes_(tab).length==0},currentRouteChanged:function(currentRoute){if(currentRoute==settings.routes.CLEAR_BROWSER_DATA){chrome.metricsPrivate.recordUserAction("ClearBrowsingData_DialogCreated");this.dialogOpenedTime_=Date.now()}},updateSyncState_:function(signedIn,syncing){this.isSignedIn_=signedIn;this.isSyncingHistory_=syncing;this.$.clearBrowsingDataDialog.classList.add("fully-rendered")},browsingCheckboxLabel_:function(isSignedIn,isSyncingHistory,historySummary,historySummarySigned,historySummarySynced){if(isSyncingHistory){return historySummarySynced}else if(isSignedIn){return historySummarySigned}return historySummary},siteSettingsLabel_:function(siteSettings,contentSettings){return loadTimeData.getBoolean("enableSiteSettings")?siteSettings:contentSettings},updateCounterText_:function(prefName,text){const matches=prefName.match(/^browser\.clear_data\.(\w+)$/);this.set("counters_."+assert(matches[1]),text)},shouldShowImportantSites_:function(){if(!this.importantSitesFlagEnabled_)return false;const tab=this.$.tabs.selectedItem;if(!tab.querySelector(".cookies-checkbox").checked){return false}const haveImportantSites=this.importantSites_.length>0;chrome.send("metricsHandler:recordBooleanHistogram",["History.ClearBrowsingData.ImportantDialogShown",haveImportantSites]);return haveImportantSites},onClearBrowsingDataTap_:function(){if(this.shouldShowImportantSites_()){const tab=this.$.tabs.selectedItem;this.showImportantSitesDialog_=true;this.showImportantSitesCacheSubtitle_=tab.querySelector(".cache-checkbox").checked;this.$.clearBrowsingDataDialog.close();this.async(()=>this.$$("#importantSitesDialog").showModal())}else{this.clearBrowsingData_()}},onClearBrowsingDataDialogClose_:function(event){if(this.showImportantSitesDialog_)event.stopPropagation()},getSelectedDataTypes_:function(tab){const checkboxes=tab.querySelectorAll("settings-checkbox");const dataTypes=[];checkboxes.forEach(checkbox=>{if(checkbox.checked&&!checkbox.hidden)dataTypes.push(checkbox.pref.key)});return dataTypes},clearBrowsingData_:function(){this.clearingInProgress_=true;const tab=this.$.tabs.selectedItem;const dataTypes=this.getSelectedDataTypes_(tab);const timePeriod=tab.querySelector(".time-range-select").pref.value;if(tab.id=="basic-tab"){chrome.metricsPrivate.recordUserAction("ClearBrowsingData_BasicTab")}else{chrome.metricsPrivate.recordUserAction("ClearBrowsingData_AdvancedTab")}this.browserProxy_.clearBrowsingData(dataTypes,timePeriod,this.importantSites_).then(shouldShowNotice=>{this.clearingInProgress_=false;this.showHistoryDeletionDialog_=shouldShowNotice;chrome.metricsPrivate.recordMediumTime("History.ClearBrowsingData.TimeSpentInDialog",Date.now()-this.dialogOpenedTime_);if(!shouldShowNotice)this.closeDialogs_()})},closeDialogs_:function(){if(this.$.clearBrowsingDataDialog.open)this.$.clearBrowsingDataDialog.close();if(this.showImportantSitesDialog_)this.$$("#importantSitesDialog").close()},onCancelTap_:function(){this.$.clearBrowsingDataDialog.cancel()},onImportantSitesConfirmTap_:function(){this.clearBrowsingData_()},onImportantSitesCancelTap_:function(){this.$$("#importantSitesDialog").cancel()},onHistoryDeletionDialogClose_:function(){this.showHistoryDeletionDialog_=false;this.closeDialogs_()},recordTabChange_:function(event){if(event.detail.value==0){chrome.metricsPrivate.recordUserAction("ClearBrowsingData_SwitchTo_BasicTab")}else{chrome.metricsPrivate.recordUserAction("ClearBrowsingData_SwitchTo_AdvancedTab")}}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
cr.exportPath("settings");settings.ContentSettingsTypes={COOKIES:"cookies",IMAGES:"images",JAVASCRIPT:"javascript",SOUND:"sound",PLUGINS:"plugins",POPUPS:"popups",GEOLOCATION:"location",NOTIFICATIONS:"notifications",MIC:"media-stream-mic",CAMERA:"media-stream-camera",PROTOCOL_HANDLERS:"register-protocol-handler",UNSANDBOXED_PLUGINS:"ppapi-broker",AUTOMATIC_DOWNLOADS:"multiple-automatic-downloads",BACKGROUND_SYNC:"background-sync",MIDI_DEVICES:"midi-sysex",USB_DEVICES:"usb-devices",ZOOM_LEVELS:"zoom-levels",PROTECTED_CONTENT:"protected-content",ADS:"ads",CLIPBOARD:"clipboard",SENSORS:"sensors",PAYMENT_HANDLER:"payment-handler"};settings.ContentSetting={DEFAULT:"default",ALLOW:"allow",BLOCK:"block",ASK:"ask",SESSION_ONLY:"session_only",IMPORTANT_CONTENT:"detect_important_content"};settings.SiteSettingSource={ADS_FILTER_BLACKLIST:"ads-filter-blacklist",DEFAULT:"default",DRM_DISABLED:"drm-disabled",EMBARGO:"embargo",EXTENSION:"extension",INSECURE_ORIGIN:"insecure-origin",KILL_SWITCH:"kill-switch",POLICY:"policy",PREFERENCE:"preference"};settings.ALL_SITES="all-sites";settings.INVALID_CATEGORY_SUBTYPE="";
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
const ContentSettingProvider={EXTENSION:"extension",PREFERENCE:"preference"};let RawSiteException;let SiteException;let DefaultContentSetting;let MediaPickerEntry;let ProtocolHandlerEntry;let UsbDeviceDetails;let UsbDeviceEntry;let ZoomLevelEntry;cr.define("settings",function(){class SiteSettingsPrefsBrowserProxy{setDefaultValueForContentType(contentType,defaultValue){}getDefaultValueForContentType(contentType){}getExceptionList(contentType){}getOriginPermissions(origin,contentTypes){}setOriginPermissions(origin,contentTypes,blanketSetting){}clearFlashPref(origin){}resetCategoryPermissionForPattern(primaryPattern,secondaryPattern,contentType,incognito){}setCategoryPermissionForPattern(primaryPattern,secondaryPattern,contentType,value,incognito){}isOriginValid(origin){}isPatternValid(pattern){}getDefaultCaptureDevices(type){}setDefaultCaptureDevice(type,defaultValue){}observeProtocolHandlers(){}observeProtocolHandlersEnabledState(){}setProtocolHandlerDefault(enabled){}setProtocolDefault(protocol,url){}removeProtocolHandler(protocol,url){}fetchUsbDevices(){}removeUsbDevice(origin,embeddingOrigin,usbDevice){}updateIncognitoStatus(){}fetchZoomLevels(){}removeZoomLevel(host){}}class SiteSettingsPrefsBrowserProxyImpl{setDefaultValueForContentType(contentType,defaultValue){chrome.send("setDefaultValueForContentType",[contentType,defaultValue])}getDefaultValueForContentType(contentType){return cr.sendWithPromise("getDefaultValueForContentType",contentType)}getExceptionList(contentType){return cr.sendWithPromise("getExceptionList",contentType)}getOriginPermissions(origin,contentTypes){return cr.sendWithPromise("getOriginPermissions",origin,contentTypes)}setOriginPermissions(origin,contentTypes,blanketSetting){chrome.send("setOriginPermissions",[origin,contentTypes,blanketSetting])}clearFlashPref(origin){chrome.send("clearFlashPref",[origin])}resetCategoryPermissionForPattern(primaryPattern,secondaryPattern,contentType,incognito){chrome.send("resetCategoryPermissionForPattern",[primaryPattern,secondaryPattern,contentType,incognito])}setCategoryPermissionForPattern(primaryPattern,secondaryPattern,contentType,value,incognito){chrome.send("setCategoryPermissionForPattern",[primaryPattern,"",contentType,value,incognito])}isOriginValid(origin){return cr.sendWithPromise("isOriginValid",origin)}isPatternValid(pattern){return cr.sendWithPromise("isPatternValid",pattern)}getDefaultCaptureDevices(type){chrome.send("getDefaultCaptureDevices",[type])}setDefaultCaptureDevice(type,defaultValue){chrome.send("setDefaultCaptureDevice",[type,defaultValue])}observeProtocolHandlers(){chrome.send("observeProtocolHandlers")}observeProtocolHandlersEnabledState(){chrome.send("observeProtocolHandlersEnabledState")}setProtocolHandlerDefault(enabled){chrome.send("setHandlersEnabled",[enabled])}setProtocolDefault(protocol,url){chrome.send("setDefault",[protocol,url])}removeProtocolHandler(protocol,url){chrome.send("removeHandler",[protocol,url])}fetchUsbDevices(){return cr.sendWithPromise("fetchUsbDevices")}removeUsbDevice(origin,embeddingOrigin,usbDevice){chrome.send("removeUsbDevice",[origin,embeddingOrigin,usbDevice])}updateIncognitoStatus(){chrome.send("updateIncognitoStatus")}fetchZoomLevels(){chrome.send("fetchZoomLevels")}removeZoomLevel(host){chrome.send("removeZoomLevel",[host])}}cr.addSingletonGetter(SiteSettingsPrefsBrowserProxyImpl);return{SiteSettingsPrefsBrowserProxy:SiteSettingsPrefsBrowserProxy,SiteSettingsPrefsBrowserProxyImpl:SiteSettingsPrefsBrowserProxyImpl}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
const kControlledByLookup={extension:chrome.settingsPrivate.ControlledBy.EXTENSION,HostedApp:chrome.settingsPrivate.ControlledBy.EXTENSION,platform_app:chrome.settingsPrivate.ControlledBy.EXTENSION,policy:chrome.settingsPrivate.ControlledBy.USER_POLICY};const SiteSettingsBehaviorImpl={properties:{category:String,browserProxy:Object},created:function(){this.browserProxy=settings.SiteSettingsPrefsBrowserProxyImpl.getInstance()},ready:function(){this.ContentSetting=settings.ContentSetting},ensureUrlHasScheme:function(url){if(url.length==0)return url;return url.includes("://")?url:"http://"+url},sanitizePort:function(url){const urlWithScheme=this.ensureUrlHasScheme(url);if(urlWithScheme.startsWith("https://")&&urlWithScheme.endsWith(":443")){return url.slice(0,-4)}if(urlWithScheme.startsWith("http://")&&urlWithScheme.endsWith(":80")){return url.slice(0,-3)}return url},removePatternWildcard:function(pattern){if(pattern.startsWith("http://[*.]"))return pattern.replace("http://[*.]","http://");else if(pattern.startsWith("https://[*.]"))return pattern.replace("https://[*.]","https://");else if(pattern.startsWith("[*.]"))return pattern.substring(4,pattern.length);return pattern},computeSiteIcon:function(site){site=this.removePatternWildcard(site);const url=this.ensureUrlHasScheme(site);return"background-image: "+cr.icon.getFavicon(url)},computeIsSettingEnabled:function(setting){return setting!=settings.ContentSetting.BLOCK},toUrl:function(originOrPattern){if(originOrPattern.length==0)return null;originOrPattern=originOrPattern.replace("*://","");originOrPattern=originOrPattern.replace("[*.]","");return new URL(this.ensureUrlHasScheme(originOrPattern))},expandSiteException:function(exception){const origin=exception.origin;const embeddingOrigin=exception.embeddingOrigin;let enforcement=null;if(exception.source=="extension"||exception.source=="HostedApp"||exception.source=="platform_app"||exception.source=="policy"){enforcement=chrome.settingsPrivate.Enforcement.ENFORCED}const controlledBy=kControlledByLookup[exception.source]||chrome.settingsPrivate.ControlledBy.PRIMARY_USER;return{category:this.category,origin:origin,displayName:exception.displayName,embeddingOrigin:embeddingOrigin,incognito:exception.incognito,setting:exception.setting,enforcement:enforcement,controlledBy:controlledBy}}};const SiteSettingsBehavior=[SiteSettingsBehaviorImpl];
// Copyright 2018 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"site-entry",behaviors:[SiteSettingsBehavior],properties:{site:Object},ready:function(){},onOriginTap_:function(event){settings.navigateTo(settings.routes.SITE_SETTINGS_SITE_DETAILS,new URLSearchParams("site="+this.site.origin))}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"all-sites",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{sites:{type:Array,value:function(){return[]}}},ready:function(){this.browserProxy_=settings.SiteSettingsPrefsBrowserProxyImpl.getInstance();this.addWebUIListener("contentSettingSitePermissionChanged",this.populateList_.bind(this));this.populateList_()},getAllSitesList_:function(){const promiseList=[];const types=Object.values(settings.ContentSettingsTypes);for(let i=0;i<types.length;i++){const type=types[i];if(type==settings.ContentSettingsTypes.PROTECTED_CONTENT)continue;if(type==settings.ContentSettingsTypes.PROTOCOL_HANDLERS||type==settings.ContentSettingsTypes.ZOOM_LEVELS){continue}promiseList.push(this.browserProxy_.getExceptionList(type))}return Promise.all(promiseList)},populateList_:function(){this.getAllSitesList_().then(this.processExceptions_.bind(this))},processExceptions_:function(data){const sites=[];for(let i=0;i<data.length;++i){const exceptionList=data[i];for(let k=0;k<exceptionList.length;++k){sites.push(exceptionList[k])}}this.sites=this.toSiteArray_(sites)},toSiteArray_:function(sites){const self=this;sites.sort(function(a,b){const url1=self.toUrl(a.origin);const url2=self.toUrl(b.origin);let comparison=url1.host.localeCompare(url2.host);if(comparison==0){comparison=url1.protocol.localeCompare(url2.protocol);if(comparison==0){comparison=url1.port.localeCompare(url2.port);if(comparison==0){let host1=self.toUrl(a.embeddingOrigin);let host2=self.toUrl(b.embeddingOrigin);host1=host1==null?"":host1.host;host2=host2==null?"":host2.host;return host1.localeCompare(host2)}}}return comparison});const results=[];let lastOrigin="";let lastEmbeddingOrigin="";for(let i=0;i<sites.length;++i){if(sites[i].origin==lastOrigin&&sites[i].embeddingOrigin==lastEmbeddingOrigin){continue}const siteException=this.expandSiteException(sites[i]);results.push(siteException);lastOrigin=siteException.origin;lastEmbeddingOrigin=siteException.embeddingOrigin}return results}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"category-default-setting",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{optionDescription:String,subOptionDescription:String,subOptionLabel:String,toggleOffLabel:String,toggleOnLabel:String,controlParams_:{type:Object,value:function(){return{}}},optionLabel_:String,priorDefaultContentSetting_:{type:Object,value:function(){return{}}},subControlParams_:{type:Object,value:function(){return{}}}},observers:["onCategoryChanged_(category)","onChangePermissionControl_(category, controlParams_.value, "+"subControlParams_.value)"],ready:function(){this.addWebUIListener("contentSettingCategoryChanged",this.onCategoryChanged_.bind(this))},get categoryEnabled(){return!!assert(this.controlParams_).value},onChangePermissionControl_:function(){if(this.controlParams_.enforcement==chrome.settingsPrivate.Enforcement.ENFORCED){return}switch(this.category){case settings.ContentSettingsTypes.ADS:case settings.ContentSettingsTypes.BACKGROUND_SYNC:case settings.ContentSettingsTypes.IMAGES:case settings.ContentSettingsTypes.JAVASCRIPT:case settings.ContentSettingsTypes.SOUND:case settings.ContentSettingsTypes.SENSORS:case settings.ContentSettingsTypes.PAYMENT_HANDLER:case settings.ContentSettingsTypes.POPUPS:case settings.ContentSettingsTypes.PROTOCOL_HANDLERS:this.browserProxy.setDefaultValueForContentType(this.category,this.categoryEnabled?settings.ContentSetting.ALLOW:settings.ContentSetting.BLOCK);break;case settings.ContentSettingsTypes.AUTOMATIC_DOWNLOADS:case settings.ContentSettingsTypes.CAMERA:case settings.ContentSettingsTypes.CLIPBOARD:case settings.ContentSettingsTypes.GEOLOCATION:case settings.ContentSettingsTypes.MIC:case settings.ContentSettingsTypes.NOTIFICATIONS:case settings.ContentSettingsTypes.UNSANDBOXED_PLUGINS:case settings.ContentSettingsTypes.MIDI_DEVICES:case settings.ContentSettingsTypes.USB_DEVICES:this.browserProxy.setDefaultValueForContentType(this.category,this.categoryEnabled?settings.ContentSetting.ASK:settings.ContentSetting.BLOCK);break;case settings.ContentSettingsTypes.COOKIES:let value=settings.ContentSetting.BLOCK;if(this.categoryEnabled){value=this.subControlParams_.value?settings.ContentSetting.SESSION_ONLY:settings.ContentSetting.ALLOW}this.browserProxy.setDefaultValueForContentType(this.category,value);break;case settings.ContentSettingsTypes.PLUGINS:this.browserProxy.setDefaultValueForContentType(this.category,this.categoryEnabled?settings.ContentSetting.IMPORTANT_CONTENT:settings.ContentSetting.BLOCK);break;default:assertNotReached("Invalid category: "+this.category)}},updateControlParams_:function(update){if(this.priorDefaultContentSetting_.setting==update.setting&&this.priorDefaultContentSetting_.source==update.source){return}this.priorDefaultContentSetting_=update;const basePref={key:"controlParams",type:chrome.settingsPrivate.PrefType.BOOLEAN};if(update.source!==undefined&&update.source!=ContentSettingProvider.PREFERENCE){basePref.enforcement=chrome.settingsPrivate.Enforcement.ENFORCED;basePref.controlledBy=update.source==ContentSettingProvider.EXTENSION?chrome.settingsPrivate.ControlledBy.EXTENSION:chrome.settingsPrivate.ControlledBy.USER_POLICY}const prefValue=this.computeIsSettingEnabled(update.setting);this.controlParams_=Object.assign({value:prefValue},basePref);const subPrefValue=this.category==settings.ContentSettingsTypes.COOKIES&&update.setting==settings.ContentSetting.SESSION_ONLY;this.subControlParams_=Object.assign({value:subPrefValue},basePref)},onCategoryChanged_:function(){this.browserProxy.getDefaultValueForContentType(this.category).then(defaultValue=>{this.updateControlParams_(defaultValue);const categoryEnabled=this.computeIsSettingEnabled(defaultValue.setting);this.optionLabel_=categoryEnabled?this.toggleOnLabel:this.toggleOffLabel})},isToggleDisabled_:function(){return this.category==settings.ContentSettingsTypes.POPUPS&&loadTimeData.getBoolean("isGuest")}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"add-site-dialog",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{category:String,contentSetting:String,showIncognitoSessionOnly_:Boolean,site_:String},attached:function(){assert(this.category);assert(this.contentSetting)},open:function(){this.addWebUIListener("onIncognitoStatusChanged",hasIncognito=>{this.$.incognito.checked=false;this.showIncognitoSessionOnly_=hasIncognito&&!loadTimeData.getBoolean("isGuest")&&this.contentSetting!=settings.ContentSetting.SESSION_ONLY});this.browserProxy.updateIncognitoStatus();this.$.dialog.showModal()},validate_:function(){if(this.$.site.value.trim()==""){this.$.site.invalid=false;this.$.add.disabled=true;return}this.browserProxy.isPatternValid(this.site_).then(isValid=>{this.$.site.invalid=!isValid;this.$.add.disabled=!isValid})},onCancelTap_:function(){this.$.dialog.cancel()},onSubmit_:function(){if(this.$.add.disabled)return;this.browserProxy.setCategoryPermissionForPattern(this.site_,this.site_,this.category,this.contentSetting,this.$.incognito.checked);this.$.dialog.close()}});
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-edit-exception-dialog",properties:{model:{type:Object,observer:"modelChanged_"},origin_:String,invalid_:{type:Boolean,value:false}},browserProxy_:null,attached:function(){this.browserProxy_=settings.SiteSettingsPrefsBrowserProxyImpl.getInstance();this.origin_=this.model.origin;this.$.dialog.showModal()},onCancelTap_:function(){this.$.dialog.close()},onActionButtonTap_:function(){if(this.model.origin!=this.origin_){this.browserProxy_.resetCategoryPermissionForPattern(this.model.origin,this.model.embeddingOrigin,this.model.category,this.model.incognito);this.browserProxy_.setCategoryPermissionForPattern(this.origin_,this.origin_,this.model.category,this.model.setting,this.model.incognito)}this.$.dialog.close()},validate_:function(){if(this.$$("paper-input").value.trim()==""){this.invalid_=true;return}this.browserProxy_.isPatternValid(this.origin_).then(isValid=>{this.invalid_=!isValid})},modelChanged_:function(){if(!this.model)this.$.dialog.cancel()}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"site-list",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{enableSiteSettings_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSiteSettings")}},readOnlyList:{type:Boolean,value:false},actionMenuSite_:Object,showEditExceptionDialog_:Boolean,sites:{type:Array,value:function(){return[]}},categorySubtype:{type:String,value:settings.INVALID_CATEGORY_SUBTYPE},showAllowAction_:Boolean,showBlockAction_:Boolean,showSessionOnlyAction_:Boolean,actions_:{readOnly:true,type:Object,values:{ALLOW:"Allow",BLOCK:"Block",RESET:"Reset",SESSION_ONLY:"SessionOnly"}}},activeDialogAnchor_:null,observers:["configureWidget_(category, categorySubtype)"],ready:function(){this.addWebUIListener("contentSettingSitePermissionChanged",this.siteWithinCategoryChanged_.bind(this));this.addWebUIListener("onIncognitoStatusChanged",this.onIncognitoStatusChanged_.bind(this))},siteWithinCategoryChanged_:function(category,site){if(category==this.category)this.configureWidget_()},onIncognitoStatusChanged_:function(){if(this.categorySubtype==settings.ContentSetting.SESSION_ONLY)return;this.populateList_()},configureWidget_:function(){if(this.browserProxy_===undefined){this.browserProxy_=settings.SiteSettingsPrefsBrowserProxyImpl.getInstance()}this.setUpActionMenu_();this.populateList_();if(this.categorySubtype==settings.ContentSetting.SESSION_ONLY){this.$.category.hidden=this.category!=settings.ContentSettingsTypes.COOKIES}},hasSites_:function(){return!!this.sites.length},shouldHideResetButton_:function(exception,readOnlyList){return exception.enforcement==chrome.settingsPrivate.Enforcement.ENFORCED||!(readOnlyList||!!exception.embeddingOrigin)},shouldHideActionMenu_:function(exception,readOnlyList){return exception.enforcement==chrome.settingsPrivate.Enforcement.ENFORCED||readOnlyList||!!exception.embeddingOrigin},onAddSiteTap_:function(e){assert(!this.readOnlyList);e.preventDefault();const dialog=document.createElement("add-site-dialog");dialog.category=this.category;dialog.contentSetting=this.categorySubtype;this.shadowRoot.appendChild(dialog);dialog.open(this.categorySubtype);dialog.addEventListener("close",()=>{cr.ui.focusWithoutInk(assert(this.$.addSite));dialog.remove()})},populateList_:function(){this.browserProxy_.getExceptionList(this.category).then(exceptionList=>{this.processExceptions_([exceptionList]);this.closeActionMenu_()})},processExceptions_:function(data){const sites=[];for(let i=0;i<data.length;++i){const exceptionList=data[i];for(let k=0;k<exceptionList.length;++k){if(exceptionList[k].setting==settings.ContentSetting.DEFAULT||exceptionList[k].setting!=this.categorySubtype){continue}sites.push(exceptionList[k])}}this.sites=this.toSiteArray_(sites)},toSiteArray_:function(sites){const results=[];let lastOrigin="";let lastEmbeddingOrigin="";for(let i=0;i<sites.length;++i){const siteException=this.expandSiteException(sites[i]);results.push(siteException);lastOrigin=siteException.origin;lastEmbeddingOrigin=siteException.embeddingOrigin}return results},setUpActionMenu_:function(){this.showAllowAction_=this.categorySubtype!=settings.ContentSetting.ALLOW;this.showBlockAction_=this.categorySubtype!=settings.ContentSetting.BLOCK;this.showSessionOnlyAction_=this.categorySubtype!=settings.ContentSetting.SESSION_ONLY&&this.category==settings.ContentSettingsTypes.COOKIES},showSessionOnlyActionForSite_:function(){if(!this.actionMenuSite_||this.actionMenuSite_.incognito)return false;return this.showSessionOnlyAction_},onOriginTap_:function(event){if(!this.enableSiteSettings_)return;settings.navigateTo(settings.routes.SITE_SETTINGS_SITE_DETAILS,new URLSearchParams("site="+event.model.item.origin))},resetPermissionForOrigin_:function(site){assert(site);this.browserProxy.resetCategoryPermissionForPattern(site.origin,site.embeddingOrigin,this.category,site.incognito)},setContentSettingForActionMenuSite_:function(contentSetting){assert(this.actionMenuSite_);this.browserProxy.setCategoryPermissionForPattern(this.actionMenuSite_.origin,this.actionMenuSite_.embeddingOrigin,this.category,contentSetting,this.actionMenuSite_.incognito)},onAllowTap_:function(){this.setContentSettingForActionMenuSite_(settings.ContentSetting.ALLOW);this.closeActionMenu_()},onBlockTap_:function(){this.setContentSettingForActionMenuSite_(settings.ContentSetting.BLOCK);this.closeActionMenu_()},onSessionOnlyTap_:function(){this.setContentSettingForActionMenuSite_(settings.ContentSetting.SESSION_ONLY);this.closeActionMenu_()},onEditTap_:function(){this.$$("cr-action-menu").close();this.showEditExceptionDialog_=true},onEditExceptionDialogClosed_:function(){this.showEditExceptionDialog_=false;this.actionMenuSite_=null;if(this.activeDialogAnchor_){this.activeDialogAnchor_.focus();this.activeDialogAnchor_=null}},onResetTap_:function(){this.resetPermissionForOrigin_(this.actionMenuSite_);this.closeActionMenu_()},computeSiteDescription_:function(item){let displayName="";if(item.embeddingOrigin){displayName=loadTimeData.getStringF("embeddedOnHost",this.sanitizePort(item.embeddingOrigin))}else if(this.category==settings.ContentSettingsTypes.GEOLOCATION){displayName=loadTimeData.getString("embeddedOnAnyHost")}if(item.incognito){if(displayName.length>0)return loadTimeData.getStringF("embeddedIncognitoSite",displayName);return loadTimeData.getString("incognitoSite")}return displayName},onResetButtonTap_:function(e){this.resetPermissionForOrigin_(e.model.item)},onShowActionMenuTap_:function(e){this.activeDialogAnchor_=Polymer.dom(e).localTarget;this.actionMenuSite_=e.model.item;this.$$("cr-action-menu").showAt(this.activeDialogAnchor_)},closeActionMenu_:function(){this.actionMenuSite_=null;this.activeDialogAnchor_=null;const actionMenu=this.$$("cr-action-menu");if(actionMenu.open)actionMenu.close()}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"category-setting-exceptions",properties:{readOnlyList:{type:Boolean,value:false},blockHeader:String},ready:function(){this.ContentSetting=settings.ContentSetting}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"media-picker",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{type:String,label:String,devices:Array},ready:function(){this.addWebUIListener("updateDevicesMenu",this.updateDevicesMenu_.bind(this));this.browserProxy.getDefaultCaptureDevices(this.type)},updateDevicesMenu_:function(type,devices,defaultDevice){if(type!=this.type)return;this.$.picker.hidden=devices.length==0;if(devices.length>0){this.devices=devices;this.async(()=>{this.$.mediaPicker.value=defaultDevice})}},onChange_:function(){this.browserProxy.setDefaultCaptureDevice(this.type,this.$.mediaPicker.value)}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-pdf-documents",properties:{prefs:{type:Object,notify:true}}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
const MenuActions={SET_DEFAULT:"SetDefault",REMOVE:"Remove"};let HandlerEntry;let ProtocolEntry;Polymer({is:"protocol-handlers",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{categoryEnabled:Boolean,protocols:Array,actionMenuModel_:Object,toggleOffLabel:String,toggleOnLabel:String,ignoredProtocols:Array},ready:function(){this.addWebUIListener("setHandlersEnabled",this.setHandlersEnabled_.bind(this));this.addWebUIListener("setProtocolHandlers",this.setProtocolHandlers_.bind(this));this.addWebUIListener("setIgnoredProtocolHandlers",this.setIgnoredProtocolHandlers_.bind(this));this.browserProxy.observeProtocolHandlers()},categoryLabelClicked_:function(){this.$.toggle.click()},computeHandlersDescription_:function(){return this.categoryEnabled?this.toggleOnLabel:this.toggleOffLabel},setHandlersEnabled_:function(enabled){this.categoryEnabled=enabled},setProtocolHandlers_:function(protocols){this.protocols=protocols},setIgnoredProtocolHandlers_:function(ignoredProtocols){this.ignoredProtocols=ignoredProtocols},closeActionMenu_:function(){this.$$("cr-action-menu").close();this.actionMenuModel_=null},onToggleChange_:function(event){this.browserProxy.setProtocolHandlerDefault(this.categoryEnabled)},onDefaultClick_:function(){const item=this.actionMenuModel_;this.browserProxy.setProtocolDefault(item.protocol,item.spec);this.closeActionMenu_()},onRemoveClick_:function(){const item=this.actionMenuModel_;this.browserProxy.removeProtocolHandler(item.protocol,item.spec);this.closeActionMenu_()},onRemoveIgnored_:function(event){const item=event.model.item;this.browserProxy.removeProtocolHandler(item.protocol,item.spec)},showMenu_:function(event){this.actionMenuModel_=event.model.item;this.$$("cr-action-menu").showAt(Polymer.dom(event).localTarget)}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
let CookieDetails;let CookieDataForDisplay;const cookieInfo={cookie:[["name","cookieName"],["content","cookieContent"],["domain","cookieDomain"],["path","cookiePath"],["sendfor","cookieSendFor"],["accessibleToScript","cookieAccessibleToScript"],["created","cookieCreated"],["expires","cookieExpires"]],app_cache:[["manifest","appCacheManifest"],["size","localStorageSize"],["created","cookieCreated"],["accessed","cookieLastAccessed"]],database:[["name","cookieName"],["desc","webdbDesc"],["size","localStorageSize"],["modified","localStorageLastModified"]],local_storage:[["origin","localStorageOrigin"],["size","localStorageSize"],["modified","localStorageLastModified"]],indexed_db:[["origin","indexedDbOrigin"],["size","indexedDbSize"],["modified","indexedDbLastModified"]],file_system:[["origin","fileSystemOrigin"],["persistent","fileSystemPersistentUsage"],["temporary","fileSystemTemporaryUsage"]],channel_id:[["serverId","channelIdServerId"],["certType","channelIdType"],["created","channelIdCreated"]],service_worker:[["origin","serviceWorkerOrigin"],["size","serviceWorkerSize"],["scopes","serviceWorkerScopes"]],shared_worker:[["worker","sharedWorkerWorker"],["name","sharedWorkerName"]],cache_storage:[["origin","cacheStorageOrigin"],["size","cacheStorageSize"],["modified","cacheStorageLastModified"]],flash_lso:[["domain","cookieDomain"]],media_license:[["origin","mediaLicenseOrigin"],["size","mediaLicenseSize"],["modified","mediaLicenseLastModified"]]};const getCookieData=function(data){const out=[];const fields=cookieInfo[data.type];for(let i=0;i<fields.length;i++){const field=fields[i];const key=field[0];if(data[key].length>0){const entry={label:loadTimeData.getString(field[1]),content:data[key]};out.push(entry)}}return out};
// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
let CookieList;let LocalDataItem;let LocalDataList;cr.define("settings",function(){class LocalDataBrowserProxy{getDisplayList(filter){}removeAll(){}removeShownItems(){}removeItem(id){}getCookieDetails(site){}reloadCookies(){}removeCookie(path){}}class LocalDataBrowserProxyImpl{getDisplayList(filter){return cr.sendWithPromise("localData.getDisplayList",filter)}removeAll(){return cr.sendWithPromise("localData.removeAll")}removeShownItems(){chrome.send("localData.removeShownItems")}removeItem(id){chrome.send("localData.removeItem",[id])}getCookieDetails(site){return cr.sendWithPromise("localData.getCookieDetails",site)}reloadCookies(){return cr.sendWithPromise("localData.reload")}removeCookie(path){chrome.send("localData.removeCookie",[path])}}cr.addSingletonGetter(LocalDataBrowserProxyImpl);return{LocalDataBrowserProxy:LocalDataBrowserProxy,LocalDataBrowserProxyImpl:LocalDataBrowserProxyImpl}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
(function(){"use strict";const categoryLabels={app_cache:loadTimeData.getString("cookieAppCache"),cache_storage:loadTimeData.getString("cookieCacheStorage"),channel_id:loadTimeData.getString("cookieChannelId"),database:loadTimeData.getString("cookieDatabaseStorage"),file_system:loadTimeData.getString("cookieFileSystem"),flash_lso:loadTimeData.getString("cookieFlashLso"),indexed_db:loadTimeData.getString("cookieDatabaseStorage"),local_storage:loadTimeData.getString("cookieLocalStorage"),service_worker:loadTimeData.getString("cookieServiceWorker"),shared_worker:loadTimeData.getString("cookieSharedWorker"),media_license:loadTimeData.getString("cookieMediaLicense")};Polymer({is:"site-data-details-subpage",behaviors:[settings.RouteObserverBehavior,WebUIListenerBehavior],properties:{entries_:Array,pageTitle:{type:String,notify:true},site_:String,siteId_:String},browserProxy_:null,ready:function(){this.browserProxy_=settings.LocalDataBrowserProxyImpl.getInstance();this.addWebUIListener("on-tree-item-removed",this.getCookieDetails_.bind(this))},currentRouteChanged:function(route){if(settings.getCurrentRoute()!=settings.routes.SITE_SETTINGS_DATA_DETAILS)return;const site=settings.getQueryParameters().get("site");if(!site)return;this.site_=site;this.pageTitle=loadTimeData.getStringF("siteSettingsCookieSubpage",site);this.getCookieDetails_()},getCookieDetails_:function(){if(!this.site_)return;this.browserProxy_.getCookieDetails(this.site_).then(this.onCookiesLoaded_.bind(this),this.onCookiesLoadFailed_.bind(this))},getCookieNodes_:function(node){return getCookieData(node)},onCookiesLoaded_:function(cookies){this.siteId_=cookies.id;this.entries_=cookies.children;this.entries_.forEach(function(e){e.expanded_=false})},onCookiesLoadFailed_:function(){this.siteId_="";this.entries_=[]},getEntryDescription_:function(item){if(item.type=="cookie")return item.title;if(item.type=="quota")return item.totalUsage;return categoryLabels[item.type]},onRemove_:function(event){this.browserProxy_.removeCookie(event.currentTarget.dataset.idPath)},removeAll:function(){this.browserProxy_.removeCookie(this.siteId_)}})})();
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"usb-devices",behaviors:[SiteSettingsBehavior],properties:{devices_:Array,actionMenuModel_:Object},ready:function(){this.fetchUsbDevices_()},fetchUsbDevices_:function(){this.browserProxy.fetchUsbDevices().then(deviceList=>{this.devices_=deviceList})},hasDevices_:function(){return!!(this.devices_&&this.devices_.length)},onRemoveTap_:function(){this.$$("cr-action-menu").close();const item=this.actionMenuModel_;this.browserProxy.removeUsbDevice(item.origin,item.embeddingOrigin,item.object);this.actionMenuModel_=null;this.fetchUsbDevices_()},showMenu_:function(event){this.actionMenuModel_=event.model.item;this.$$("cr-action-menu").showAt(Polymer.dom(event).localTarget)}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
let CookieDataSummaryItem;let CookieRemovePacket;function DomRepeatEvent(){}DomRepeatEvent.prototype.model;Polymer({is:"site-data",behaviors:[I18nBehavior,ListPropertyUpdateBehavior,settings.GlobalScrollTargetBehavior,WebUIListenerBehavior],properties:{filter:{observer:"updateSiteList_",notify:true,type:String},focusConfig:{type:Object,observer:"focusConfigChanged_"},isLoading_:Boolean,sites:{type:Array,value:function(){return[]}},subpageRoute:{type:Object,value:settings.routes.SITE_SETTINGS_SITE_DATA}},browserProxy_:null,ready:function(){this.browserProxy_=settings.LocalDataBrowserProxyImpl.getInstance();this.addWebUIListener("on-tree-item-removed",this.updateSiteList_.bind(this))},currentRouteChanged:function(currentRoute){settings.GlobalScrollTargetBehaviorImpl.currentRouteChanged.call(this,currentRoute);if(currentRoute==settings.routes.SITE_SETTINGS_SITE_DATA){this.isLoading_=true;this.browserProxy_.reloadCookies().then(this.updateSiteList_.bind(this))}},favicon_:function(url){const urlWithScheme=url.includes("://")?url:"http://"+url;return cr.icon.getFavicon(urlWithScheme)},focusConfigChanged_:function(newConfig,oldConfig){assert(!oldConfig);if(settings.routes.SITE_SETTINGS_DATA_DETAILS){this.focusConfig.set(settings.routes.SITE_SETTINGS_DATA_DETAILS.path,"* /deep/ #filter /deep/ #searchInput")}},updateSiteList_:function(){this.isLoading_=true;this.browserProxy_.getDisplayList(this.filter).then(listInfo=>{this.updateList("sites",item=>item.site,listInfo.items);this.isLoading_=false;this.fire("site-data-list-complete")})},computeRemoveLabel_:function(filter){if(filter.length==0)return loadTimeData.getString("siteSettingsCookieRemoveAll");return loadTimeData.getString("siteSettingsCookieRemoveAllShown")},onCloseDialog_:function(){this.$.confirmDeleteDialog.close()},onConfirmDeleteDialogClosed_:function(){cr.ui.focusWithoutInk(assert(this.$.removeShowingSites))},onRemoveShowingSitesTap_:function(e){e.preventDefault();this.$.confirmDeleteDialog.showModal()},onConfirmDelete_:function(){this.$.confirmDeleteDialog.close();if(this.filter.length==0){this.browserProxy_.removeAll().then(()=>{this.sites=[]})}else{this.browserProxy_.removeShownItems();this.fire("clear-subpage-search")}},onRemoveSiteTap_:function(e){e.stopPropagation();this.browserProxy_.removeItem(e.model.item.site)},onSiteTap_:function(event){settings.navigateTo(settings.routes.SITE_SETTINGS_DATA_DETAILS,new URLSearchParams("site="+event.model.item.site))}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"site-details-permission",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{site:Object,defaultSetting_:String},observers:["siteChanged_(site)"],attached:function(){this.addWebUIListener("contentSettingCategoryChanged",this.onDefaultSettingChanged_.bind(this))},siteChanged_:function(site){if(site.source==settings.SiteSettingSource.DEFAULT){this.defaultSetting_=site.setting;this.$.permission.value=settings.ContentSetting.DEFAULT}else{this.updateDefaultPermission_(site);this.$.permission.value=site.setting}if(this.isNonDefaultAsk_(site.setting,site.source)){assert(this.$.permission.disabled,"The 'Ask' entry is for display-only and cannot be set by the "+"user.");assert(this.$.permission.value==settings.ContentSetting.ASK,"'Ask' should only show up when it's currently selected.")}},updateDefaultPermission_:function(site){this.browserProxy.getDefaultValueForContentType(this.category).then(defaultValue=>{this.defaultSetting_=defaultValue.setting})},onDefaultSettingChanged_:function(category){if(category==this.category)this.updateDefaultPermission_(this.site)},onPermissionSelectionChange_:function(){this.browserProxy.setOriginPermissions(this.site.origin,[this.category],this.$.permission.value)},defaultSettingString_:function(defaultSetting,askString,allowString,blockString){if(defaultSetting==settings.ContentSetting.ASK||defaultSetting==settings.ContentSetting.IMPORTANT_CONTENT){return askString}else if(defaultSetting==settings.ContentSetting.ALLOW){return allowString}else if(defaultSetting==settings.ContentSetting.BLOCK){return blockString}assertNotReached(`No string for ${this.category}'s default of ${defaultSetting}`)},hasPermissionInfoString_:function(source,category,setting){return this.permissionInfoString_(source,category,setting,null,null,null,null,null,null,null,null,null,null,null,null)!=""},permissionInfoStringClass_:function(source,category,setting){return this.hasPermissionInfoString_(source,category,setting)?"two-line":""},isPermissionUserControlled_:function(source){return!(source==settings.SiteSettingSource.DRM_DISABLED||source==settings.SiteSettingSource.POLICY||source==settings.SiteSettingSource.EXTENSION||source==settings.SiteSettingSource.KILL_SWITCH||source==settings.SiteSettingSource.INSECURE_ORIGIN)},showAllowedSetting_:function(category){return category!=settings.ContentSettingsTypes.USB_DEVICES},showAskSetting_:function(category,setting,source){if(category==settings.ContentSettingsTypes.USB_DEVICES)return true;return this.isNonDefaultAsk_(setting,source)},isNonDefaultAsk_:function(setting,source){if(setting!=settings.ContentSetting.ASK||source==settings.SiteSettingSource.DEFAULT){return false}assert(source==settings.SiteSettingSource.EXTENSION||source==settings.SiteSettingSource.POLICY,"Only extensions or enterprise policy can change the setting to ASK.");return true},permissionInfoString_:function(source,category,setting,adsBlacklistString,adsBlockString,embargoString,insecureOriginString,killSwitchString,extensionAllowString,extensionBlockString,extensionAskString,policyAllowString,policyBlockString,policyAskString,drmDisabledString){const extensionStrings={};extensionStrings[settings.ContentSetting.ALLOW]=extensionAllowString;extensionStrings[settings.ContentSetting.BLOCK]=extensionBlockString;extensionStrings[settings.ContentSetting.ASK]=extensionAskString;const policyStrings={};policyStrings[settings.ContentSetting.ALLOW]=policyAllowString;policyStrings[settings.ContentSetting.BLOCK]=policyBlockString;policyStrings[settings.ContentSetting.ASK]=policyAskString;if(source==settings.SiteSettingSource.ADS_FILTER_BLACKLIST){assert(settings.ContentSettingsTypes.ADS==category,"The ads filter blacklist only applies to Ads.");return adsBlacklistString}else if(category==settings.ContentSettingsTypes.ADS&&setting==settings.ContentSetting.BLOCK){return adsBlockString}else if(source==settings.SiteSettingSource.DRM_DISABLED){assert(settings.ContentSetting.BLOCK==setting,"If DRM is disabled, Protected Content must be blocked.");assert(settings.ContentSettingsTypes.PROTECTED_CONTENT==category,"The DRM disabled source only applies to Protected Content.");if(!drmDisabledString){return null}return loadTimeData.sanitizeInnerHtml(loadTimeData.substituteString(drmDisabledString,settings.routes.SITE_SETTINGS_PROTECTED_CONTENT.getAbsolutePath()))}else if(source==settings.SiteSettingSource.EMBARGO){assert(settings.ContentSetting.BLOCK==setting,"Embargo is only used to block permissions.");return embargoString}else if(source==settings.SiteSettingSource.EXTENSION){return extensionStrings[setting]}else if(source==settings.SiteSettingSource.INSECURE_ORIGIN){assert(settings.ContentSetting.BLOCK==setting,"Permissions can only be blocked due to insecure origins.");return insecureOriginString}else if(source==settings.SiteSettingSource.KILL_SWITCH){assert(settings.ContentSetting.BLOCK==setting,"The permissions kill switch can only be used to block permissions.");return killSwitchString}else if(source==settings.SiteSettingSource.POLICY){return policyStrings[setting]}else if(source==settings.SiteSettingSource.DEFAULT||source==settings.SiteSettingSource.PREFERENCE){return""}assertNotReached(`No string for ${category} setting source '${source}'`)}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
(function(){"use strict";Polymer({is:"website-usage-private-api",properties:{websiteDataUsage:{type:String,notify:true},websiteStorageType:{type:Number,notify:true}},attached:function(){settings.WebsiteUsagePrivateApi.websiteUsagePolymerInstance=this},fetchUsageTotal:function(host){settings.WebsiteUsagePrivateApi.fetchUsageTotal(host)},clearUsage:function(origin,type){settings.WebsiteUsagePrivateApi.clearUsage(origin,type)},notifyUsageDeleted:function(origin){this.fire("usage-deleted",{origin:origin})}})})();cr.define("settings.WebsiteUsagePrivateApi",function(){const websiteUsagePolymerInstance=null;let hostName;const fetchUsageTotal=function(host){const instance=settings.WebsiteUsagePrivateApi.websiteUsagePolymerInstance;if(instance!=null)instance.websiteDataUsage="";hostName=host;chrome.send("fetchUsageTotal",[host])};const returnUsageTotal=function(host,usage,type){const instance=settings.WebsiteUsagePrivateApi.websiteUsagePolymerInstance;if(instance==null)return;if(hostName==host){instance.websiteDataUsage=usage;instance.websiteStorageType=type}};const clearUsage=function(origin,type){chrome.send("clearUsage",[origin,type])};const onUsageCleared=function(origin){const instance=settings.WebsiteUsagePrivateApi.websiteUsagePolymerInstance;if(instance==null)return;instance.notifyUsageDeleted(origin)};return{websiteUsagePolymerInstance:websiteUsagePolymerInstance,fetchUsageTotal:fetchUsageTotal,returnUsageTotal:returnUsageTotal,clearUsage:clearUsage,onUsageCleared:onUsageCleared}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"site-details",behaviors:[SiteSettingsBehavior,settings.RouteObserverBehavior,WebUIListenerBehavior],properties:{origin:{type:String,observer:"onOriginChanged_"},pageTitle:{type:String,notify:true},storedData_:{type:String,value:""},enableSiteSettings_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSiteSettings")}},enableSafeBrowsingSubresourceFilter_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSafeBrowsingSubresourceFilter")}},enableSoundContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSoundContentSetting")}},enableClipboardContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableClipboardContentSetting")}},enableSensorsContentSetting_:{type:Boolean,readOnly:true,value:function(){return loadTimeData.getBoolean("enableSensorsContentSetting")}},enablePaymentHandlerContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enablePaymentHandlerContentSetting")}},storageType_:Number},listeners:{"usage-deleted":"onUsageDeleted_"},attached:function(){this.addWebUIListener("contentSettingSitePermissionChanged",this.onPermissionChanged_.bind(this))},ready:function(){this.ContentSettingsTypes=settings.ContentSettingsTypes},currentRouteChanged:function(route){const site=settings.getQueryParameters().get("site");if(!site)return;this.origin=site},onOriginChanged_:function(){this.browserProxy.isOriginValid(this.origin).then(valid=>{if(!valid){settings.navigateToPreviousRoute()}else{if(this.enableSiteSettings_)this.$.usageApi.fetchUsageTotal(this.toUrl(this.origin).hostname);this.updatePermissions_(this.getCategoryList_())}})},onPermissionChanged_:function(category,origin,embeddingOrigin){if(this.origin===undefined||this.origin==""||origin===undefined||origin==""){return}if(!this.getCategoryList_().includes(category))return;if(this.toUrl(origin).origin==this.toUrl(this.origin).origin)this.updatePermissions_([category])},updatePermissions_:function(categoryList){const permissionsMap=Array.prototype.reduce.call(this.root.querySelectorAll("site-details-permission"),(map,element)=>{if(categoryList.includes(element.category))map[element.category]=element;return map},{});this.browserProxy.getOriginPermissions(this.origin,categoryList).then(exceptionList=>{exceptionList.forEach((exception,i)=>{permissionsMap[categoryList[i]].site=exception});assert(exceptionList.length>0);this.pageTitle=exceptionList[0].displayName})},onCloseDialog_:function(){this.$.confirmDeleteDialog.close()},onConfirmClearSettings_:function(e){e.preventDefault();this.$.confirmDeleteDialog.showModal()},onClearStorage_:function(){if(this.enableSiteSettings_)this.$.usageApi.clearUsage(this.toUrl(this.origin).href,this.storageType_)},onUsageDeleted_:function(event){if(event.detail.origin==this.toUrl(this.origin).href)this.storedData_=""},onClearAndReset_:function(){this.browserProxy.setOriginPermissions(this.origin,this.getCategoryList_(),settings.ContentSetting.DEFAULT);if(this.getCategoryList_().includes(settings.ContentSettingsTypes.PLUGINS))this.browserProxy.clearFlashPref(this.origin);if(this.storedData_!="")this.onClearStorage_();this.onCloseDialog_()},getCategoryList_:function(){const categoryList=[];this.root.querySelectorAll("site-details-permission").forEach(element=>{if(!element.hidden)categoryList.push(element.category)});return categoryList},permissionListClass_:function(hasHeading){return hasHeading?"":"without-heading"},hasUsage_:function(storage){return storage!=""}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"zoom-levels",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{sites_:Array},ready:function(){this.addWebUIListener("onZoomLevelsChanged",this.onZoomLevelsChanged_.bind(this));this.browserProxy.fetchZoomLevels()},onZoomLevelsChanged_:function(sites){this.sites_=sites},removeZoomLevel_:function(event){const site=this.sites_[event.model.index];this.browserProxy.removeZoomLevel(site.origin)}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-site-settings-page",behaviors:[SiteSettingsBehavior,WebUIListenerBehavior],properties:{default_:{type:Object,value:function(){return{}}},enableSiteSettings_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSiteSettings")}},isGuest_:{type:Boolean,value:function(){return loadTimeData.getBoolean("isGuest")}},enableSafeBrowsingSubresourceFilter_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSafeBrowsingSubresourceFilter")}},enableClipboardContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableClipboardContentSetting")}},enableSoundContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSoundContentSetting")}},enableSensorsContentSetting_:{type:Boolean,readOnly:true,value:function(){return loadTimeData.getBoolean("enableSensorsContentSetting")}},enablePaymentHandlerContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enablePaymentHandlerContentSetting")}},focusConfig:{type:Object,observer:"focusConfigChanged_"}},focusConfigChanged_:function(newConfig,oldConfig){assert(!oldConfig);const R=settings.routes;const pairs=[[R.SITE_SETTINGS_COOKIES,"cookies"],[R.SITE_SETTINGS_LOCATION,"location"],[R.SITE_SETTINGS_CAMERA,"camera"],[R.SITE_SETTINGS_MICROPHONE,"microphone"],[R.SITE_SETTINGS_NOTIFICATIONS,"notifications"],[R.SITE_SETTINGS_JAVASCRIPT,"javascript"],[R.SITE_SETTINGS_SOUND,"sound"],[R.SITE_SETTINGS_FLASH,"flash"],[R.SITE_SETTINGS_IMAGES,"images"],[R.SITE_SETTINGS_POPUPS,"popups"],[R.SITE_SETTINGS_BACKGROUND_SYNC,"background-sync"],[R.SITE_SETTINGS_AUTOMATIC_DOWNLOADS,"automatic-downloads"],[R.SITE_SETTINGS_UNSANDBOXED_PLUGINS,"unsandboxed-plugins"],[R.SITE_SETTINGS_HANDLERS,"protocol-handlers"],[R.SITE_SETTINGS_MIDI_DEVICES,"midi-devices"],[R.SITE_SETTINGS_ADS,"ads"],[R.SITE_SETTINGS_ZOOM_LEVELS,"zoom-levels"],[R.SITE_SETTINGS_USB_DEVICES,"usb-devices"],[R.SITE_SETTINGS_PDF_DOCUMENTS,"pdf-documents"],[R.SITE_SETTINGS_PROTECTED_CONTENT,"protected-content"],[R.SITE_SETTINGS_CLIPBOARD,"clipboard"],[R.SITE_SETTINGS_SENSORS,"sensors"]];if(this.enablePaymentHandlerContentSetting_){pairs.push([R.SITE_SETTINGS_PAYMENT_HANDLER,"payment-handler"])}pairs.forEach(pair=>{const route=pair[0];const id=pair[1];this.focusConfig.set(route.path,"* /deep/ #"+id+" .subpage-arrow")})},ready:function(){this.ContentSettingsTypes=settings.ContentSettingsTypes;this.ALL_SITES=settings.ALL_SITES;const keys=Object.keys(settings.ContentSettingsTypes);for(let i=0;i<keys.length;++i){const key=settings.ContentSettingsTypes[keys[i]];if(key==settings.ContentSettingsTypes.ZOOM_LEVELS)continue;if(this.isGuest_&&key==settings.ContentSettingsTypes.PROTOCOL_HANDLERS){continue}if(key==settings.ContentSettingsTypes.PROTECTED_CONTENT)continue;this.updateDefaultValueLabel_(key)}this.addWebUIListener("contentSettingCategoryChanged",this.updateDefaultValueLabel_.bind(this));this.addWebUIListener("setHandlersEnabled",this.updateHandlersEnabled_.bind(this));this.browserProxy.observeProtocolHandlersEnabledState()},defaultSettingLabel_:function(setting,enabled,disabled,other){if(setting==settings.ContentSetting.BLOCK)return disabled;if(setting==settings.ContentSetting.ALLOW)return enabled;if(other)return other;return enabled},updateDefaultValueLabel_:function(category){this.browserProxy.getDefaultValueForContentType(category).then(defaultValue=>{this.set("default_."+Polymer.CaseMap.dashToCamelCase(category),defaultValue.setting)})},updateHandlersEnabled_:function(enabled){const category=settings.ContentSettingsTypes.PROTOCOL_HANDLERS;this.set("default_."+Polymer.CaseMap.dashToCamelCase(category),enabled?settings.ContentSetting.ALLOW:settings.ContentSetting.BLOCK)},onTapNavigate_:function(event){const dataSet=event.currentTarget.dataset;settings.navigateTo(settings.routes[dataSet.route])}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
var CertificateSubnode;var NewCertificateSubNode;var Certificate;var CaTrustInfo;var CertificatesError;var CertificateType={CA:"ca",OTHER:"other",PERSONAL:"personal",SERVER:"server"};var CertificatesImportError;cr.define("certificate_manager",function(){class CertificatesBrowserProxy{refreshCertificates(){}viewCertificate(id){}exportCertificate(id){}deleteCertificate(id){}getCaCertificateTrust(id){}editCaCertificateTrust(id,ssl,email,objSign){}cancelImportExportCertificate(){}exportPersonalCertificate(id){}exportPersonalCertificatePasswordSelected(password){}importPersonalCertificate(useHardwareBacked){}importPersonalCertificatePasswordSelected(password){}importCaCertificate(){}importCaCertificateTrustSelected(ssl,email,objSign){}importServerCertificate(){}}class CertificatesBrowserProxyImpl{refreshCertificates(){chrome.send("refreshCertificates")}viewCertificate(id){chrome.send("viewCertificate",[id])}exportCertificate(id){chrome.send("exportCertificate",[id])}deleteCertificate(id){return cr.sendWithPromise("deleteCertificate",id)}exportPersonalCertificate(id){return cr.sendWithPromise("exportPersonalCertificate",id)}exportPersonalCertificatePasswordSelected(password){return cr.sendWithPromise("exportPersonalCertificatePasswordSelected",password)}importPersonalCertificate(useHardwareBacked){return cr.sendWithPromise("importPersonalCertificate",useHardwareBacked)}importPersonalCertificatePasswordSelected(password){return cr.sendWithPromise("importPersonalCertificatePasswordSelected",password)}getCaCertificateTrust(id){return cr.sendWithPromise("getCaCertificateTrust",id)}editCaCertificateTrust(id,ssl,email,objSign){return cr.sendWithPromise("editCaCertificateTrust",id,ssl,email,objSign)}importCaCertificateTrustSelected(ssl,email,objSign){return cr.sendWithPromise("importCaCertificateTrustSelected",ssl,email,objSign)}cancelImportExportCertificate(){chrome.send("cancelImportExportCertificate")}importCaCertificate(){return cr.sendWithPromise("importCaCertificate")}importServerCertificate(){return cr.sendWithPromise("importServerCertificate")}}cr.addSingletonGetter(CertificatesBrowserProxyImpl);return{CertificatesBrowserProxy:CertificatesBrowserProxy,CertificatesBrowserProxyImpl:CertificatesBrowserProxyImpl}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"ca-trust-edit-dialog",behaviors:[I18nBehavior],properties:{model:Object,trustInfo_:Object,explanationText_:String},browserProxy_:null,ready:function(){this.browserProxy_=certificate_manager.CertificatesBrowserProxyImpl.getInstance()},attached:function(){this.explanationText_=loadTimeData.getStringF("certificateManagerCaTrustEditDialogExplanation",this.model.name);if(this.model.id){this.browserProxy_.getCaCertificateTrust(this.model.id).then(trustInfo=>{this.trustInfo_=trustInfo;this.$.dialog.showModal()})}else{this.$.dialog.showModal()}},onCancelTap_:function(){this.$.dialog.close()},onOkTap_:function(){this.$.spinner.active=true;var whenDone=this.model.id?this.browserProxy_.editCaCertificateTrust(this.model.id,this.$.ssl.checked,this.$.email.checked,this.$.objSign.checked):this.browserProxy_.importCaCertificateTrustSelected(this.$.ssl.checked,this.$.email.checked,this.$.objSign.checked);whenDone.then(()=>{this.$.spinner.active=false;this.$.dialog.close()},error=>{this.$.dialog.close();this.fire("certificates-error",{error:error,anchor:null})})}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"certificate-delete-confirmation-dialog",behaviors:[I18nBehavior],properties:{model:Object,certificateType:String},browserProxy_:null,ready:function(){this.browserProxy_=certificate_manager.CertificatesBrowserProxyImpl.getInstance()},attached:function(){this.$.dialog.showModal()},getTitleText_:function(){var getString=localizedMessageId=>loadTimeData.getStringF(localizedMessageId,this.model.name);switch(this.certificateType){case CertificateType.PERSONAL:return getString("certificateManagerDeleteUserTitle");case CertificateType.SERVER:return getString("certificateManagerDeleteServerTitle");case CertificateType.CA:return getString("certificateManagerDeleteCaTitle");case CertificateType.OTHER:return getString("certificateManagerDeleteOtherTitle")}assertNotReached()},getDescriptionText_:function(){var getString=loadTimeData.getString.bind(loadTimeData);switch(this.certificateType){case CertificateType.PERSONAL:return getString("certificateManagerDeleteUserDescription");case CertificateType.SERVER:return getString("certificateManagerDeleteServerDescription");case CertificateType.CA:return getString("certificateManagerDeleteCaDescription");case CertificateType.OTHER:return""}assertNotReached()},onCancelTap_:function(){this.$.dialog.close()},onOkTap_:function(){this.browserProxy_.deleteCertificate(this.model.id).then(()=>{this.$.dialog.close()},error=>{this.$.dialog.close();this.fire("certificates-error",{error:error,anchor:null})})}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
var CertificateActionEventDetail;var CertificatesErrorEventDetail;var CertificateAction={DELETE:0,EDIT:1,EXPORT_PERSONAL:2,IMPORT:3};var CertificateActionEvent="certificate-action";
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"certificate-subentry",behaviors:[I18nBehavior],properties:{model:Object,certificateType:String},browserProxy_:null,created:function(){this.browserProxy_=certificate_manager.CertificatesBrowserProxyImpl.getInstance()},dispatchCertificateActionEvent_:function(action){this.fire(CertificateActionEvent,{action:action,subnode:this.model,certificateType:this.certificateType,anchor:this.$.dots})},onRejected_:function(error){if(error===null){return}this.fire("certificates-error",{error:error,anchor:this.$.dots})},onViewTap_:function(event){this.closePopupMenu_();this.browserProxy_.viewCertificate(this.model.id)},onEditTap_:function(event){this.closePopupMenu_();this.dispatchCertificateActionEvent_(CertificateAction.EDIT)},onDeleteTap_:function(event){this.closePopupMenu_();this.dispatchCertificateActionEvent_(CertificateAction.DELETE)},onExportTap_:function(event){this.closePopupMenu_();if(this.certificateType==CertificateType.PERSONAL){this.browserProxy_.exportPersonalCertificate(this.model.id).then(()=>{this.dispatchCertificateActionEvent_(CertificateAction.EXPORT_PERSONAL)},this.onRejected_.bind(this))}else{this.browserProxy_.exportCertificate(this.model.id)}},canEdit_:function(certificateType,model){return certificateType==CertificateType.CA&&!model.policy},canExport_:function(certificateType,model){if(certificateType==CertificateType.PERSONAL){return model.extractable}return true},canDelete_:function(model){return!model.readonly&&!model.policy},closePopupMenu_:function(){this.$$("cr-action-menu").close()},onDotsTap_:function(){var actionMenu=this.$.menu.get();actionMenu.showAt(this.$.dots)}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"certificate-entry",behaviors:[I18nBehavior],properties:{model:Object,certificateType:String},isLast_:function(index){return index==this.model.subnodes.length-1}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"certificate-list",properties:{certificates:{type:Array,value:function(){return[]}},certificateType:String,isGuest_:{type:Boolean,value:function(){return loadTimeData.valueExists("isGuest")&&loadTimeData.getBoolean("isGuest")}},isKiosk_:{type:Boolean,value:function(){return loadTimeData.valueExists("isKiosk")&&loadTimeData.getBoolean("isKiosk")}}},behaviors:[I18nBehavior],getDescription_:function(){if(this.certificates.length==0)return this.i18n("certificateManagerNoCertificates");switch(this.certificateType){case CertificateType.PERSONAL:return this.i18n("certificateManagerYourCertificatesDescription");case CertificateType.SERVER:return this.i18n("certificateManagerServersDescription");case CertificateType.CA:return this.i18n("certificateManagerAuthoritiesDescription");case CertificateType.OTHER:return this.i18n("certificateManagerOthersDescription")}assertNotReached()},canImport_:function(){return!this.isKiosk_&&this.certificateType!=CertificateType.OTHER},
// <if expr="chromeos">
canImportAndBind_:function(){return!this.isGuest_&&this.certificateType==CertificateType.PERSONAL},
// </if>
onRejected_:function(anchor,error){if(error===null){return}this.fire("certificates-error",{error:error,anchor:anchor})},dispatchImportActionEvent_:function(subnode,anchor){this.fire(CertificateActionEvent,{action:CertificateAction.IMPORT,subnode:subnode,certificateType:this.certificateType,anchor:anchor})},onImportTap_:function(e){this.handleImport_(false,Polymer.dom(e).localTarget)},
// <if expr="chromeos">
onImportAndBindTap_:function(e){this.handleImport_(true,Polymer.dom(e).localTarget)},
// </if>
handleImport_:function(useHardwareBacked,anchor){var browserProxy=certificate_manager.CertificatesBrowserProxyImpl.getInstance();if(this.certificateType==CertificateType.PERSONAL){browserProxy.importPersonalCertificate(useHardwareBacked).then(showPasswordPrompt=>{if(showPasswordPrompt)this.dispatchImportActionEvent_(null,anchor)},this.onRejected_.bind(this,anchor))}else if(this.certificateType==CertificateType.CA){browserProxy.importCaCertificate().then(certificateName=>{this.dispatchImportActionEvent_({name:certificateName},anchor)},this.onRejected_.bind(this,anchor))}else if(this.certificateType==CertificateType.SERVER){browserProxy.importServerCertificate().catch(this.onRejected_.bind(this,anchor))}else{assertNotReached()}}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"certificate-password-decryption-dialog",behaviors:[I18nBehavior],properties:{password_:{type:String,value:""}},browserProxy_:null,ready:function(){this.browserProxy_=certificate_manager.CertificatesBrowserProxyImpl.getInstance()},attached:function(){this.$.dialog.showModal()},onCancelTap_:function(){this.$.dialog.close()},onOkTap_:function(){this.browserProxy_.importPersonalCertificatePasswordSelected(this.password_).then(()=>{this.$.dialog.close()},error=>{this.$.dialog.close();this.fire("certificates-error",{error:error,anchor:null})})}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"certificate-password-encryption-dialog",behaviors:[I18nBehavior],properties:{model:Object,password_:{type:String,value:""},confirmPassword_:{type:String,value:""}},browserProxy_:null,ready:function(){this.browserProxy_=certificate_manager.CertificatesBrowserProxyImpl.getInstance()},attached:function(){this.$.dialog.showModal()},onCancelTap_:function(){this.$.dialog.close()},onOkTap_:function(){this.browserProxy_.exportPersonalCertificatePasswordSelected(this.password_).then(()=>{this.$.dialog.close()},error=>{this.$.dialog.close();this.fire("certificates-error",{error:error,anchor:null})})},validate_:function(){var isValid=this.password_!=""&&this.password_==this.confirmPassword_;this.$.ok.disabled=!isValid}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"certificates-error-dialog",behaviors:[I18nBehavior],properties:{model:Object},attached:function(){this.$.dialog.showModal()},onOkTap_:function(){this.$.dialog.close()},getCertificateErrorText_:function(importError){return loadTimeData.getStringF("certificateImportErrorFormat",importError.name,importError.error)}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"certificate-manager",behaviors:[I18nBehavior,WebUIListenerBehavior],properties:{selected:{type:Number,value:0},personalCerts:{type:Array,value:function(){return[]}},serverCerts:{type:Array,value:function(){return[]}},caCerts:{type:Array,value:function(){return[]}},otherCerts:{type:Array,value:function(){return[]}},certificateTypeEnum_:{type:Object,value:CertificateType,readOnly:true},showCaTrustEditDialog_:Boolean,showDeleteConfirmationDialog_:Boolean,showPasswordEncryptionDialog_:Boolean,showPasswordDecryptionDialog_:Boolean,showErrorDialog_:Boolean,dialogModel_:Object,dialogModelCertificateType_:String,errorDialogModel_:Object,activeDialogAnchor_:Object,isKiosk_:{type:Boolean,value:function(){return loadTimeData.valueExists("isKiosk")&&loadTimeData.getBoolean("isKiosk")}}},attached:function(){this.addWebUIListener("certificates-changed",this.set.bind(this));certificate_manager.CertificatesBrowserProxyImpl.getInstance().refreshCertificates()},isTabSelected_:function(selectedIndex,tabIndex){return selectedIndex==tabIndex},ready:function(){this.addEventListener(CertificateActionEvent,event=>{this.dialogModel_=event.detail.subnode;this.dialogModelCertificateType_=event.detail.certificateType;if(event.detail.action==CertificateAction.IMPORT){if(event.detail.certificateType==CertificateType.PERSONAL){this.openDialog_("certificate-password-decryption-dialog","showPasswordDecryptionDialog_",event.detail.anchor)}else if(event.detail.certificateType==CertificateType.CA){this.openDialog_("ca-trust-edit-dialog","showCaTrustEditDialog_",event.detail.anchor)}}else{if(event.detail.action==CertificateAction.EDIT){this.openDialog_("ca-trust-edit-dialog","showCaTrustEditDialog_",event.detail.anchor)}else if(event.detail.action==CertificateAction.DELETE){this.openDialog_("certificate-delete-confirmation-dialog","showDeleteConfirmationDialog_",event.detail.anchor)}else if(event.detail.action==CertificateAction.EXPORT_PERSONAL){this.openDialog_("certificate-password-encryption-dialog","showPasswordEncryptionDialog_",event.detail.anchor)}}event.stopPropagation()});this.addEventListener("certificates-error",event=>{var detail=event.detail;this.errorDialogModel_=detail.error;this.openDialog_("certificates-error-dialog","showErrorDialog_",detail.anchor);event.stopPropagation()})},openDialog_:function(dialogTagName,domIfBooleanName,anchor){if(anchor)this.activeDialogAnchor_=anchor;this.set(domIfBooleanName,true);this.async(()=>{var dialog=this.$$(dialogTagName);dialog.addEventListener("close",()=>{this.set(domIfBooleanName,false);cr.ui.focusWithoutInk(assert(this.activeDialogAnchor_))})})}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
(function(){Polymer({is:"settings-privacy-page",behaviors:[settings.RouteObserverBehavior,I18nBehavior,WebUIListenerBehavior],properties:{prefs:{type:Object,notify:true},pageVisibility:Object,isGuest_:{type:Boolean,value:function(){return loadTimeData.getBoolean("isGuest")}},showClearBrowsingDataDialog_:Boolean,showDoNotTrackDialog_:{type:Boolean,value:false},enableSafeBrowsingSubresourceFilter_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSafeBrowsingSubresourceFilter")}},enableSoundContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableSoundContentSetting")}},enableClipboardContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enableClipboardContentSetting")}},enablePaymentHandlerContentSetting_:{type:Boolean,value:function(){return loadTimeData.getBoolean("enablePaymentHandlerContentSetting")}},enableSensorsContentSetting_:{type:Boolean,readOnly:true,value:function(){return loadTimeData.getBoolean("enableSensorsContentSetting")}},focusConfig_:{type:Object,value:function(){const map=new Map;if(settings.routes.CERTIFICATES){map.set(settings.routes.CERTIFICATES.path,"#manageCertificates .subpage-arrow")}if(settings.routes.SITE_SETTINGS){map.set(settings.routes.SITE_SETTINGS.path,"#site-settings-subpage-trigger .subpage-arrow")}return map}},unifiedConsentEnabled_:{type:Boolean,value:function(){return loadTimeData.getBoolean("unifiedConsentEnabled")}}},listeners:{"doNotTrackDialogIf.dom-change":"onDoNotTrackDomChange_"},ready:function(){this.ContentSettingsTypes=settings.ContentSettingsTypes;this.browserProxy_=settings.PrivacyPageBrowserProxyImpl.getInstance()},currentRouteChanged:function(){this.showClearBrowsingDataDialog_=settings.getCurrentRoute()==settings.routes.CLEAR_BROWSER_DATA},onDoNotTrackDomChange_:function(event){if(this.showDoNotTrackDialog_)this.maybeShowDoNotTrackDialog_()},onDoNotTrackChange_:function(event){const target=event.target;if(!target.checked){target.sendPrefChange();return}this.showDoNotTrackDialog_=true;this.maybeShowDoNotTrackDialog_()},maybeShowDoNotTrackDialog_:function(){const dialog=this.$$("#confirmDoNotTrackDialog");if(dialog&&!dialog.open)dialog.showModal()},closeDoNotTrackDialog_:function(){this.$$("#confirmDoNotTrackDialog").close();this.showDoNotTrackDialog_=false},onDoNotTrackDialogClosed_:function(){cr.ui.focusWithoutInk(this.$.doNotTrack)},onDoNotTrackDialogConfirm_:function(){this.$.doNotTrack.sendPrefChange();this.closeDoNotTrackDialog_()},onDoNotTrackDialogCancel_:function(){this.$.doNotTrack.resetToPrefValue();this.closeDoNotTrackDialog_()},onManageCertificatesTap_:function(){settings.navigateTo(settings.routes.CERTIFICATES)},onMoreSettingsBoxClicked_:function(e){if(e.target.tagName==="A"){e.preventDefault();settings.navigateTo(settings.routes.SYNC)}},onRemoveAllCookiesFromSite_:function(){const node=this.$$("site-data-details-subpage");if(node)node.removeAll()},onSiteDataTap_:function(){settings.navigateTo(settings.routes.SITE_SETTINGS_SITE_DATA)},onSiteSettingsTap_:function(){settings.navigateTo(settings.routes.SITE_SETTINGS)},onClearBrowsingDataTap_:function(){settings.navigateTo(settings.routes.CLEAR_BROWSER_DATA)},onDialogClosed_:function(){settings.navigateTo(settings.routes.CLEAR_BROWSER_DATA.parent);cr.ui.focusWithoutInk(assert(this.$.clearBrowsingDataTrigger))},siteSettingsPageTitle_:function(){return loadTimeData.getBoolean("enableSiteSettings")?loadTimeData.getString("siteSettings"):loadTimeData.getString("contentSettings")},getProtectedContentLabel_:function(value){return value?this.i18n("siteSettingsProtectedContentEnable"):this.i18n("siteSettingsBlocked")},getProtectedContentIdentifiersLabel_:function(value){return value?this.i18n("siteSettingsProtectedContentEnableIdentifiers"):this.i18n("siteSettingsBlocked")}})})();
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-reset-profile-dialog",behaviors:[WebUIListenerBehavior],properties:{isTriggered_:{type:Boolean,value:false},triggeredResetToolName_:{type:String,value:""},resetRequestOrigin_:String,clearingInProgress_:{type:Boolean,value:false}},browserProxy_:null,getExplanationText_:function(){if(this.isTriggered_){return loadTimeData.getStringF("triggeredResetPageExplanation",this.triggeredResetToolName_)}return loadTimeData.getStringF("resetPageExplanation")},getPageTitle_:function(){if(this.isTriggered_){return loadTimeData.getStringF("triggeredResetPageTitle",this.triggeredResetToolName_)}return loadTimeData.getStringF("resetDialogCommit")},ready:function(){this.browserProxy_=settings.ResetBrowserProxyImpl.getInstance();this.addEventListener("cancel",()=>{this.browserProxy_.onHideResetProfileDialog()});this.$$("cr-checkbox a").addEventListener("click",this.onShowReportedSettingsTap_.bind(this))},showDialog_:function(){if(!this.$.dialog.open)this.$.dialog.showModal();this.browserProxy_.onShowResetProfileDialog()},show:function(){this.isTriggered_=settings.getCurrentRoute()==settings.routes.TRIGGERED_RESET_DIALOG;if(this.isTriggered_){this.browserProxy_.getTriggeredResetToolName().then(name=>{this.resetRequestOrigin_="triggeredreset";this.triggeredResetToolName_=name;this.showDialog_()})}else{const origin=window.location.hash.slice(1).toLowerCase()=="cct"?"cct":settings.getQueryParameters().get("origin");this.resetRequestOrigin_=origin||"";this.showDialog_()}},onCancelTap_:function(){this.cancel()},cancel:function(){if(this.$.dialog.open)this.$.dialog.cancel()},onResetTap_:function(){this.clearingInProgress_=true;this.browserProxy_.performResetProfileSettings(this.$.sendSettings.checked,this.resetRequestOrigin_).then(()=>{this.clearingInProgress_=false;if(this.$.dialog.open)this.$.dialog.close();this.fire("reset-done")})},onShowReportedSettingsTap_:function(e){this.browserProxy_.showReportedSettings();e.stopPropagation()}});
// Copyright 2015 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-reset-page",behaviors:[settings.RouteObserverBehavior],properties:{prefs:Object,allowPowerwash_:{type:Boolean,value:cr.isChromeOS?loadTimeData.getBoolean("allowPowerwash"):false}},currentRouteChanged:function(route){const lazyRender=this.$.resetProfileDialog;if(route==settings.routes.TRIGGERED_RESET_DIALOG||route==settings.routes.RESET_DIALOG){lazyRender.get().show()}else{const dialog=lazyRender.getIfExists();if(dialog)dialog.cancel()}},onShowResetProfileDialog_:function(){settings.navigateTo(settings.routes.RESET_DIALOG,new URLSearchParams("origin=userclick"))},onResetProfileDialogClose_:function(){settings.navigateToPreviousRoute();cr.ui.focusWithoutInk(assert(this.$.resetProfileArrow))}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
cr.define("settings",function(){class SystemPageBrowserProxy{showProxySettings(){}wasHardwareAccelerationEnabledAtStartup(){}}class SystemPageBrowserProxyImpl{showProxySettings(){chrome.send("showProxySettings")}wasHardwareAccelerationEnabledAtStartup(){return loadTimeData.getBoolean("hardwareAccelerationEnabledAtStartup")}}cr.addSingletonGetter(SystemPageBrowserProxyImpl);return{SystemPageBrowserProxy:SystemPageBrowserProxy,SystemPageBrowserProxyImpl:SystemPageBrowserProxyImpl}});
// Copyright 2016 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
Polymer({is:"settings-system-page",properties:{prefs:{type:Object,notify:true},isProxyEnforcedByPolicy_:{type:Boolean,computed:"computeIsProxyEnforcedByPolicy_(prefs.proxy.*)"}},computeIsProxyEnforcedByPolicy_:function(){const pref=this.get("prefs.proxy");return pref.enforcement==chrome.settingsPrivate.Enforcement.ENFORCED&&pref.controlledBy==chrome.settingsPrivate.ControlledBy.USER_POLICY},onExtensionDisable_:function(){this.fire("refresh-pref","proxy")},onProxyTap_:function(){if(!this.isProxyEnforcedByPolicy_)settings.SystemPageBrowserProxyImpl.getInstance().showProxySettings()},onRestartTap_:function(e){e.stopPropagation();settings.LifetimeBrowserProxyImpl.getInstance().restart()},shouldShowRestart_:function(enabled){const proxy=settings.SystemPageBrowserProxyImpl.getInstance();return enabled!=proxy.wasHardwareAccelerationEnabledAtStartup()}});